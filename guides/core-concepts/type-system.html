
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Type System - Musical Time and Audio Units &#8212; TorchFX 1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=6f8f3740"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";

const defaultStyle = document.createElement('style');
defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}
`;
document.head.appendChild(defaultStyle);

const fullscreenStyle = document.createElement('style');
fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
document.head.appendChild(fullscreenStyle);

// Detect if page has dark background
const isDarkTheme = () => {
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness < 128;
    }
    return false;
};

const load = async () => {
    await mermaid.run();

    const all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(load, 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(load, 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(load, 200);
        return;
    }

    const darkTheme = isDarkTheme();

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    const modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    const modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    let previousScrollOffset = [window.scrollX, window.scrollY];

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    const allButtons = [];

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        container.appendChild(fullscreenBtn);
        allButtons.push(fullscreenBtn);
    });

    // Update theme classes when theme changes
    const updateTheme = () => {
        const dark = isDarkTheme();
        allButtons.forEach(btn => {
            if (dark) {
                btn.classList.add('dark-theme');
            } else {
                btn.classList.remove('dark-theme');
            }
        });
        if (dark) {
            modal.classList.add('dark-theme');
            modalContent.classList.add('dark-theme');
            closeBtn.classList.add('dark-theme');
        } else {
            modal.classList.remove('dark-theme');
            modalContent.classList.remove('dark-theme');
            closeBtn.classList.remove('dark-theme');
        }
    };

    // Watch for theme changes
    const observer = new MutationObserver(updateTheme);
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style']
    });
};

window.addEventListener("load", load);
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'guides/core-concepts/type-system';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Pipeline Operator - Functional Composition" href="pipeline-operator.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" /> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../blog/index/atom.xml"
  title="TorchFX Blog"
/>
  
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/tfx_black.svg" class="logo__image only-light" alt=""/>
    <img src="../../_static/tfx.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">TorchFX</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../blog/index.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../glossary.html">
    Glossary
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matteospanio/torchfx" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchfx/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Guides
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../blog/index.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../glossary.html">
    Glossary
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matteospanio/torchfx" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchfx/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting Started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/getting_started.html">Getting Started</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Core Concepts</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wave.html">Wave - Digital Audio Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="fx.html">FX - Audio Effect Base Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline-operator.html">Pipeline Operator - Functional Composition</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Type System - Musical Time and Audio Units</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/custom-filters.html">Creating Custom Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/series-parallel-filters.html">Series and Parallel Filter Combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/custom-effects.html">Creating Custom Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/multi-channel-effects.html">Multi-Channel Audio Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/bpm-delay.html">BPM-Synced Delay Effects</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced/index.html">Advanced Topics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/gpu-acceleration.html">GPU Acceleration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/pytorch-integration.html">PyTorch Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/multi-channel.html">Multi-Channel Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/performance.html">Performance Optimization and Benchmarking</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api_stability.html">API Stability and Backward Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/index.html">Developer Documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/project-structure.html">Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/style_guide.html">Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/roadmap.html">Roadmap to v1.0.0</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Guides</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Core Concepts</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Type System - Musical Time and Audio Units</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section id="type-system-musical-time-and-audio-units">
<h1>Type System - Musical Time and Audio Units<a class="headerlink" href="#type-system-musical-time-and-audio-units" title="Link to this heading">#</a></h1>
<p>TorchFX provides a rich type system designed specifically for audio processing. This system enables you to express time in musical terms (BPM, note divisions) rather than just samples or seconds, making effects more intuitive for musical applications.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The type system includes:</p>
<ul class="simple">
<li><p><strong>Musical Time</strong>: BPM-synchronized time divisions (quarter notes, eighth notes, triplets, dotted notes)</p></li>
<li><p><strong>Time Units</strong>: Seconds, milliseconds, samples</p></li>
<li><p><strong>Audio Units</strong>: Decibels, bit rates</p></li>
<li><p><strong>Device Types</strong>: CPU and CUDA device specifications</p></li>
<li><p><strong>Window Types</strong>: Window functions for spectral analysis</p></li>
</ul>
<pre  class="mermaid">
        graph TB
    subgraph &quot;TorchFX Type System&quot;
        Musical[&quot;Musical Time&lt;br/&gt;MusicalTime class&quot;]
        Time[&quot;Time Units&lt;br/&gt;Second, Millisecond&quot;]
        Audio[&quot;Audio Units&lt;br/&gt;Decibel, BitRate&quot;]
        Device[&quot;Device Types&lt;br/&gt;CPU, CUDA&quot;]
        Window[&quot;Window Types&lt;br/&gt;Hann, Hamming, etc.&quot;]
    end

    subgraph &quot;Applications&quot;
        Delay[&quot;BPM-synced Delay&quot;]
        Filter[&quot;Filters with cutoff&quot;]
        Save[&quot;Audio file saving&quot;]
        GPU[&quot;GPU acceleration&quot;]
    end

    Musical --&gt; Delay
    Time --&gt; Filter
    Audio --&gt; Save
    Device --&gt; GPU
    Window --&gt; Spectral[&quot;Spectral analysis&quot;]

    style Musical fill:#e1f5ff
    style Time fill:#fff5e1
    style Audio fill:#ffe1e1
    style Device fill:#e8f5e1
    style Window fill:#f5e1ff
    </pre></section>
<section id="musical-time">
<h2>Musical Time<a class="headerlink" href="#musical-time" title="Link to this heading">#</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MusicalTime</span></code> class represents musical time divisions as fractions of a bar (measure).</p>
<section id="basic-concept">
<h3>Basic Concept<a class="headerlink" href="#basic-concept" title="Link to this heading">#</a></h3>
<p>In music production, delays and rhythmic effects are often synchronized to the tempo (BPM). Instead of specifying delay times in milliseconds, you specify them as note divisions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1/4</span></code>: Quarter note (one beat in 4/4 time)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1/8</span></code>: Eighth note (half a beat)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1/16</span></code>: Sixteenth note (quarter of a beat)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1/2</span></code>: Half note (two beats)</p></li>
</ul>
</section>
<section id="creating-musical-times">
<h3>Creating Musical Times<a class="headerlink" href="#creating-musical-times" title="Link to this heading">#</a></h3>
<section id="from-strings">
<h4>From Strings<a class="headerlink" href="#from-strings" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MusicalTime</span>

<span class="c1"># Basic note divisions</span>
<span class="n">quarter</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/4&quot;</span><span class="p">)</span>
<span class="n">eighth</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/8&quot;</span><span class="p">)</span>
<span class="n">sixteenth</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/16&quot;</span><span class="p">)</span>

<span class="c1"># Dotted notes (1.5x duration)</span>
<span class="n">dotted_quarter</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/4d&quot;</span><span class="p">)</span>
<span class="n">dotted_eighth</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/8d&quot;</span><span class="p">)</span>

<span class="c1"># Triplets (2/3x duration)</span>
<span class="n">eighth_triplet</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/8t&quot;</span><span class="p">)</span>
<span class="n">quarter_triplet</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/4t&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="direct-construction">
<h4>Direct Construction<a class="headerlink" href="#direct-construction" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MusicalTime</span>

<span class="c1"># Create directly</span>
<span class="n">quarter</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="p">(</span><span class="n">numerator</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">denominator</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">dotted_eighth</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="p">(</span><span class="n">numerator</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">denominator</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
<span class="n">eighth_triplet</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="p">(</span><span class="n">numerator</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">denominator</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="converting-to-time">
<h3>Converting to Time<a class="headerlink" href="#converting-to-time" title="Link to this heading">#</a></h3>
<p>Convert musical time to seconds based on BPM:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MusicalTime</span>

<span class="n">quarter</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;1/4&quot;</span><span class="p">)</span>

<span class="c1"># At 120 BPM in 4/4 time</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">quarter</span><span class="o">.</span><span class="n">duration_seconds</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">beats_per_bar</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>  <span class="c1"># 0.5 seconds</span>

<span class="c1"># At 140 BPM</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">quarter</span><span class="o">.</span><span class="n">duration_seconds</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>  <span class="c1"># ~0.428 seconds</span>
</pre></div>
</div>
</section>
<section id="using-with-effects">
<h3>Using with Effects<a class="headerlink" href="#using-with-effects" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="../../api/effects.html#torchfx.effect.Delay" title="torchfx.effect.Delay"><code class="xref py py-class docutils literal notranslate"><span class="pre">Delay</span></code></a> effect uses <code class="xref py py-class docutils literal notranslate"><span class="pre">MusicalTime</span></code> for BPM-synced delays:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>

<span class="c1"># Delay synced to 128 BPM, eighth note</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Delay</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">delay_time</span><span class="o">=</span><span class="s2">&quot;1/8&quot;</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">mix</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">delayed</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">delay</span>

<span class="c1"># Dotted quarter note delay (classic rock delay)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Delay</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">delay_time</span><span class="o">=</span><span class="s2">&quot;1/4d&quot;</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mix</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">delayed</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">delay</span>

<span class="c1"># Triplet delay</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Delay</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">delay_time</span><span class="o">=</span><span class="s2">&quot;1/8t&quot;</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">mix</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">delayed</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">delay</span>
</pre></div>
</div>
</section>
<section id="mathematical-representation">
<h3>Mathematical Representation<a class="headerlink" href="#mathematical-representation" title="Link to this heading">#</a></h3>
<p>The duration of a musical time division is calculated as:</p>
<div class="math notranslate nohighlight">
\[
t = \frac{n}{d} \times m \times \frac{60}{BPM} \times \text{beats\_per\_bar}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the numerator (e.g., 1 in “1/4”)</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> is the denominator (e.g., 4 in “1/4”)</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the modifier coefficient:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(m = 1.0\)</span> for normal notes</p></li>
<li><p><span class="math notranslate nohighlight">\(m = 1.5\)</span> for dotted notes (<code class="docutils literal notranslate"><span class="pre">d</span></code>)</p></li>
<li><p><span class="math notranslate nohighlight">\(m = \frac{1}{3}\)</span> for triplets (<code class="docutils literal notranslate"><span class="pre">t</span></code>)</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(BPM\)</span> is beats per minute</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{beats\_per\_bar}\)</span> is the number of beats in a bar (default 4 for 4/4 time)</p></li>
</ul>
</section>
<section id="note-division-reference">
<h3>Note Division Reference<a class="headerlink" href="#note-division-reference" title="Link to this heading">#</a></h3>
<p>Common note divisions and their durations at 120 BPM in 4/4 time:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Division</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Modifier</p></th>
<th class="head"><p>Duration (seconds)</p></th>
<th class="head"><p>Duration (ms)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1/1</span></code></p></td>
<td><p>Whole note</p></td>
<td><p>-</p></td>
<td><p>2.000</p></td>
<td><p>2000</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1/2</span></code></p></td>
<td><p>Half note</p></td>
<td><p>-</p></td>
<td><p>1.000</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1/4</span></code></p></td>
<td><p>Quarter note</p></td>
<td><p>-</p></td>
<td><p>0.500</p></td>
<td><p>500</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1/4d</span></code></p></td>
<td><p>Dotted quarter</p></td>
<td><p>Dotted</p></td>
<td><p>0.750</p></td>
<td><p>750</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1/8</span></code></p></td>
<td><p>Eighth note</p></td>
<td><p>-</p></td>
<td><p>0.250</p></td>
<td><p>250</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1/8d</span></code></p></td>
<td><p>Dotted eighth</p></td>
<td><p>Dotted</p></td>
<td><p>0.375</p></td>
<td><p>375</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1/8t</span></code></p></td>
<td><p>Eighth triplet</p></td>
<td><p>Triplet</p></td>
<td><p>0.167</p></td>
<td><p>167</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1/16</span></code></p></td>
<td><p>Sixteenth note</p></td>
<td><p>-</p></td>
<td><p>0.125</p></td>
<td><p>125</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1/16d</span></code></p></td>
<td><p>Dotted sixteenth</p></td>
<td><p>Dotted</p></td>
<td><p>0.188</p></td>
<td><p>188</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Note_value">Note Value on Wikipedia</a> - Understanding musical time divisions</p>
</div>
</section>
</section>
<section id="time-units">
<h2>Time Units<a class="headerlink" href="#time-units" title="Link to this heading">#</a></h2>
<section id="second-and-millisecond">
<h3>Second and Millisecond<a class="headerlink" href="#second-and-millisecond" title="Link to this heading">#</a></h3>
<p>Type-annotated aliases for time values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Second</span><span class="p">,</span> <span class="n">Millisecond</span>

<span class="c1"># These are annotated types ensuring non-negative values</span>
<span class="n">duration_sec</span><span class="p">:</span> <span class="n">Second</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># 1.5 seconds</span>
<span class="n">duration_ms</span><span class="p">:</span> <span class="n">Millisecond</span> <span class="o">=</span> <span class="mf">1500.0</span>  <span class="c1"># 1500 milliseconds</span>
</pre></div>
</div>
<p>Used in <a class="reference internal" href="../../api/core.html#torchfx.Wave" title="torchfx.Wave"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave</span></code></a> duration methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>

<span class="c1"># Get duration in seconds</span>
<span class="n">duration_sec</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="s2">&quot;sec&quot;</span><span class="p">)</span>  <span class="c1"># Returns Second type</span>

<span class="c1"># Get duration in milliseconds</span>
<span class="n">duration_ms</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">)</span>  <span class="c1"># Returns Millisecond type</span>
</pre></div>
</div>
</section>
<section id="sample-based-time">
<h3>Sample-Based Time<a class="headerlink" href="#sample-based-time" title="Link to this heading">#</a></h3>
<p>Convert between samples and time units:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">fs</span>  <span class="c1"># Sample rate</span>

<span class="c1"># Samples to seconds</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">44100</span>
<span class="n">duration_sec</span> <span class="o">=</span> <span class="n">num_samples</span> <span class="o">/</span> <span class="n">fs</span>  <span class="c1"># 1.0 second at 44100 Hz</span>

<span class="c1"># Seconds to samples</span>
<span class="n">duration_sec</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration_sec</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>  <span class="c1"># 22050 samples at 44100 Hz</span>

<span class="c1"># Milliseconds to samples</span>
<span class="n">duration_ms</span> <span class="o">=</span> <span class="mf">100.0</span>  <span class="c1"># 100 ms</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">duration_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>  <span class="c1"># 4410 samples at 44100 Hz</span>
</pre></div>
</div>
</section>
</section>
<section id="audio-units">
<h2>Audio Units<a class="headerlink" href="#audio-units" title="Link to this heading">#</a></h2>
<section id="decibels">
<h3>Decibels<a class="headerlink" href="#decibels" title="Link to this heading">#</a></h3>
<p>Type-annotated for decibel values (≤ 0):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decibel</span>

<span class="c1"># Decibel values must be non-positive (≤ 0)</span>
<span class="n">gain_db</span><span class="p">:</span> <span class="n">Decibel</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0</span>  <span class="c1"># -6 dB attenuation</span>
<span class="n">reference_db</span><span class="p">:</span> <span class="n">Decibel</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># 0 dB (unity gain)</span>
</pre></div>
</div>
<p>Used in effects like <a class="reference internal" href="../../api/effects.html#torchfx.effect.Gain" title="torchfx.effect.Gain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gain</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>

<span class="c1"># Gain in decibels</span>
<span class="n">gained</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Gain</span><span class="p">(</span><span class="n">gain</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">gain_type</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">)</span>

<span class="c1"># Convert between amplitude and dB</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="n">amplitude</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>  <span class="c1"># -6.02 dB</span>

<span class="n">db_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">db_value</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># 0.501</span>
</pre></div>
</div>
</section>
<section id="bit-rate">
<h3>Bit Rate<a class="headerlink" href="#bit-rate" title="Link to this heading">#</a></h3>
<p>Audio bit depth specification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">BitRate</span>

<span class="c1"># Valid bit rates: 8, 16, 24, 32</span>
<span class="n">bit_depth</span><span class="p">:</span> <span class="n">BitRate</span> <span class="o">=</span> <span class="mi">24</span>
</pre></div>
</div>
<p>Used when saving audio files:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>

<span class="c1"># Save as 24-bit audio</span>
<span class="n">wave</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.wav&quot;</span><span class="p">,</span> <span class="n">bits_per_sample</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;PCM_S&quot;</span><span class="p">)</span>

<span class="c1"># Save as 16-bit audio (CD quality)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.wav&quot;</span><span class="p">,</span> <span class="n">bits_per_sample</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;PCM_S&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="device-types">
<h2>Device Types<a class="headerlink" href="#device-types" title="Link to this heading">#</a></h2>
<section id="cpu-and-cuda">
<h3>CPU and CUDA<a class="headerlink" href="#cpu-and-cuda" title="Link to this heading">#</a></h3>
<p>Specify where computations should run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Device</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Type can be string literal or torch.device</span>
<span class="n">device1</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
<span class="n">device2</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
<span class="n">device3</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>  <span class="c1"># Specific GPU</span>
</pre></div>
</div>
<p>Used in <a class="reference internal" href="../../api/core.html#torchfx.Wave" title="torchfx.Wave"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave</span></code></a> for device management:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>

<span class="c1"># Move to GPU</span>
<span class="n">wave</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="c1"># Check device</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># &quot;cuda&quot;</span>

<span class="c1"># Create wave directly on GPU</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://pytorch.org/docs/stable/notes/cuda.html">PyTorch CUDA Semantics</a> - Device management in PyTorch</p>
</div>
</section>
</section>
<section id="window-types">
<h2>Window Types<a class="headerlink" href="#window-types" title="Link to this heading">#</a></h2>
<section id="window-functions">
<h3>Window Functions<a class="headerlink" href="#window-functions" title="Link to this heading">#</a></h3>
<p>For spectral analysis and filter design:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">WindowType</span>

<span class="c1"># Available window types</span>
<span class="n">valid_windows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">WindowType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hamming&quot;</span><span class="p">,</span>
    <span class="s2">&quot;blackman&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kaiser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;boxcar&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bartlett&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flattop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parzen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bohman&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nuttall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;barthann&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Used in spectral analysis and filter design:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">WindowType</span>

<span class="c1"># Create window for FFT</span>
<span class="n">window_type</span><span class="p">:</span> <span class="n">WindowType</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span>
<span class="n">window_length</span> <span class="o">=</span> <span class="mi">2048</span>

<span class="c1"># Using torch directly</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hann_window</span><span class="p">(</span><span class="n">window_length</span><span class="p">)</span>

<span class="c1"># Or using scipy.signal.get_window (if needed)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span><span class="n">window_type</span><span class="p">,</span> <span class="n">window_length</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="window-characteristics">
<h3>Window Characteristics<a class="headerlink" href="#window-characteristics" title="Link to this heading">#</a></h3>
<p>Different windows have different characteristics:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Window</p></th>
<th class="head"><p>Main Lobe Width</p></th>
<th class="head"><p>Side Lobe Level</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">boxcar</span></code></p></td>
<td><p>Narrow</p></td>
<td><p>High (-13 dB)</p></td>
<td><p>Fast transitions, high resolution</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hann</span></code></p></td>
<td><p>Medium</p></td>
<td><p>Medium (-31 dB)</p></td>
<td><p>General purpose, balanced</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hamming</span></code></p></td>
<td><p>Medium</p></td>
<td><p>Low (-43 dB)</p></td>
<td><p>Low side lobes, smooth</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">blackman</span></code></p></td>
<td><p>Wide</p></td>
<td><p>Very Low (-58 dB)</p></td>
<td><p>Minimal leakage, wide transitions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kaiser</span></code></p></td>
<td><p>Adjustable</p></td>
<td><p>Adjustable</p></td>
<td><p>Configurable trade-offs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">flattop</span></code></p></td>
<td><p>Very Wide</p></td>
<td><p>Very Low</p></td>
<td><p>Amplitude accuracy</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Window_function">Window Function on Wikipedia</a> - Detailed window function analysis</p>
</div>
</section>
</section>
<section id="filter-specific-types">
<h2>Filter-Specific Types<a class="headerlink" href="#filter-specific-types" title="Link to this heading">#</a></h2>
<section id="filter-type">
<h3>Filter Type<a class="headerlink" href="#filter-type" title="Link to this heading">#</a></h3>
<p>Specify filter mode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FilterType</span>

<span class="c1"># Valid filter types</span>
<span class="n">mode1</span><span class="p">:</span> <span class="n">FilterType</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>   <span class="c1"># Low-pass</span>
<span class="n">mode2</span><span class="p">:</span> <span class="n">FilterType</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>  <span class="c1"># High-pass</span>
</pre></div>
</div>
</section>
<section id="filter-order-scale">
<h3>Filter Order Scale<a class="headerlink" href="#filter-order-scale" title="Link to this heading">#</a></h3>
<p>For displaying filter order:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FilterOrderScale</span>

<span class="c1"># Display order in dB/octave or linear units</span>
<span class="n">scale1</span><span class="p">:</span> <span class="n">FilterOrderScale</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span>       <span class="c1"># dB/octave (e.g., -40 dB/oct)</span>
<span class="n">scale2</span><span class="p">:</span> <span class="n">FilterOrderScale</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>   <span class="c1"># Linear order (e.g., order=4)</span>
</pre></div>
</div>
</section>
</section>
<section id="spectral-types">
<h2>Spectral Types<a class="headerlink" href="#spectral-types" title="Link to this heading">#</a></h2>
<section id="spectrogram-scale">
<h3>Spectrogram Scale<a class="headerlink" href="#spectrogram-scale" title="Link to this heading">#</a></h3>
<p>Specify frequency scale for spectrograms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpecScale</span>

<span class="c1"># Valid spectrogram scales</span>
<span class="n">scale1</span><span class="p">:</span> <span class="n">SpecScale</span> <span class="o">=</span> <span class="s2">&quot;mel&quot;</span>    <span class="c1"># Mel scale (perceptual)</span>
<span class="n">scale2</span><span class="p">:</span> <span class="n">SpecScale</span> <span class="o">=</span> <span class="s2">&quot;lin&quot;</span>    <span class="c1"># Linear scale</span>
<span class="n">scale3</span><span class="p">:</span> <span class="n">SpecScale</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>    <span class="c1"># Logarithmic scale</span>
</pre></div>
</div>
</section>
</section>
<section id="type-annotations-in-custom-effects">
<h2>Type Annotations in Custom Effects<a class="headerlink" href="#type-annotations-in-custom-effects" title="Link to this heading">#</a></h2>
<p>Use TorchFX types for better type safety:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.effect</span><span class="w"> </span><span class="kn">import</span> <span class="n">FX</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Second</span><span class="p">,</span> <span class="n">Millisecond</span><span class="p">,</span> <span class="n">Device</span><span class="p">,</span> <span class="n">Decibel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomEffect</span><span class="p">(</span><span class="n">FX</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom effect with type-annotated parameters.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">duration_ms</span><span class="p">:</span> <span class="n">Millisecond</span><span class="p">,</span>
        <span class="n">gain_db</span><span class="p">:</span> <span class="n">Decibel</span><span class="p">,</span>
        <span class="n">fs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">duration_ms</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Duration must be non-negative&quot;</span>
        <span class="k">assert</span> <span class="n">gain_db</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Gain in dB must be non-positive&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">duration_ms</span> <span class="o">=</span> <span class="n">duration_ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gain_db</span> <span class="o">=</span> <span class="n">gain_db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>

    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="c1"># Convert dB to linear gain</span>
        <span class="n">linear_gain</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gain_db</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>

        <span class="c1"># Convert ms to samples (if fs is set)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">duration_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">duration_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
            <span class="c1"># Use duration_samples for processing</span>

        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">linear_gain</span>
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">#</a></h2>
<section id="use-musical-time-for-rhythmic-effects">
<h3>Use Musical Time for Rhythmic Effects<a class="headerlink" href="#use-musical-time-for-rhythmic-effects" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ✅ GOOD: Musical time for delay</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Delay</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">delay_time</span><span class="o">=</span><span class="s2">&quot;1/8&quot;</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="c1"># ❌ LESS GOOD: Hardcoded samples (not tempo-aware)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">Delay</span><span class="p">(</span><span class="n">delay_samples</span><span class="o">=</span><span class="mi">5512</span><span class="p">)</span>  <span class="c1"># What BPM is this?</span>
</pre></div>
</div>
</section>
<section id="validate-type-constraints">
<h3>Validate Type Constraints<a class="headerlink" href="#validate-type-constraints" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decibel</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_gain</span><span class="p">(</span><span class="n">gain_db</span><span class="p">:</span> <span class="n">Decibel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Decibel type hints that gain_db should be ≤ 0</span>
    <span class="k">assert</span> <span class="n">gain_db</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Gain in dB must be non-positive&quot;</span>
    <span class="c1"># ... implementation</span>

<span class="c1"># This hints at incorrect usage</span>
<span class="n">set_gain</span><span class="p">(</span><span class="mf">6.0</span><span class="p">)</span>  <span class="c1"># Type checker may warn (positive dB)</span>

<span class="c1"># Correct usage</span>
<span class="n">set_gain</span><span class="p">(</span><span class="o">-</span><span class="mf">6.0</span><span class="p">)</span>  <span class="c1"># Attenuation</span>
</pre></div>
</div>
</section>
<section id="document-units-in-docstrings">
<h3>Document Units in Docstrings<a class="headerlink" href="#document-units-in-docstrings" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyEffect</span><span class="p">(</span><span class="n">FX</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom effect with time-based parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    delay_ms : Millisecond</span>
<span class="sd">        Delay time in milliseconds. Must be non-negative.</span>
<span class="sd">    gain_db : Decibel</span>
<span class="sd">        Gain in decibels. Must be non-positive (≤ 0).</span>
<span class="sd">    fs : int, optional</span>
<span class="sd">        Sample rate in Hz. If None, inferred from Wave.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="common-conversions">
<h2>Common Conversions<a class="headerlink" href="#common-conversions" title="Link to this heading">#</a></h2>
<section id="bpm-to-time">
<h3>BPM to Time<a class="headerlink" href="#bpm-to-time" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MusicalTime</span>

<span class="n">bpm</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">time_div</span> <span class="o">=</span> <span class="s2">&quot;1/4&quot;</span>  <span class="c1"># Quarter note</span>

<span class="n">musical_time</span> <span class="o">=</span> <span class="n">MusicalTime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">time_div</span><span class="p">)</span>
<span class="n">duration_sec</span> <span class="o">=</span> <span class="n">musical_time</span><span class="o">.</span><span class="n">duration_seconds</span><span class="p">(</span><span class="n">bpm</span><span class="o">=</span><span class="n">bpm</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;At </span><span class="si">{</span><span class="n">bpm</span><span class="si">}</span><span class="s2"> BPM, a </span><span class="si">{</span><span class="n">time_div</span><span class="si">}</span><span class="s2"> note lasts </span><span class="si">{</span><span class="n">duration_sec</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="c1"># At 120 BPM, a 1/4 note lasts 0.5 seconds</span>
</pre></div>
</div>
</section>
<section id="samples-to-time">
<h3>Samples to Time<a class="headerlink" href="#samples-to-time" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>  <span class="c1"># Sample rate</span>

<span class="c1"># Samples to seconds</span>
<span class="n">samples</span> <span class="o">=</span> <span class="mi">22050</span>
<span class="n">seconds</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">/</span> <span class="n">fs</span>  <span class="c1"># 0.5 seconds</span>

<span class="c1"># Samples to milliseconds</span>
<span class="n">milliseconds</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples</span> <span class="o">/</span> <span class="n">fs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># 500 ms</span>
</pre></div>
</div>
</section>
<section id="amplitude-to-decibels">
<h3>Amplitude to Decibels<a class="headerlink" href="#amplitude-to-decibels" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># Amplitude to dB</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>  <span class="c1"># -6.02 dB</span>

<span class="c1"># dB to amplitude</span>
<span class="n">db</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">db</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># 0.708</span>
</pre></div>
</div>
</section>
</section>
<section id="related-concepts">
<h2>Related Concepts<a class="headerlink" href="#related-concepts" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="wave.html"><span class="doc">Wave - Digital Audio Representation</span></a> - Uses time types for duration methods</p></li>
<li><p><a class="reference internal" href="fx.html"><span class="doc">FX - Audio Effect Base Class</span></a> - Effects use musical time and audio units</p></li>
<li><p><a class="reference internal" href="../tutorials/filters-design.html"><span class="doc">Filters Design</span></a> - Filters using window types</p></li>
<li><p><a class="reference internal" href="../tutorials/bpm-delay.html"><span class="doc">BPM-Synced Delay Effects</span></a> - BPM-synced delay using MusicalTime</p></li>
</ul>
</section>
<section id="external-resources">
<h2>External Resources<a class="headerlink" href="#external-resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Note_value">Musical Note Values on Wikipedia</a> - Understanding musical time divisions</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Decibel">Decibel on Wikipedia</a> - Understanding dB scale</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Audio_bit_depth">Audio Bit Depth on Wikipedia</a> - Bit rate and audio quality</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/typing.html">Python Type Hints</a> - Type annotation system</p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<span class="target" id="id1"></span></section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pipeline-operator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Pipeline Operator - Functional Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../tutorials/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorials</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#musical-time">Musical Time</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-concept">Basic Concept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-musical-times">Creating Musical Times</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#from-strings">From Strings</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-construction">Direct Construction</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-to-time">Converting to Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-with-effects">Using with Effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-representation">Mathematical Representation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-division-reference">Note Division Reference</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-units">Time Units</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-and-millisecond">Second and Millisecond</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-based-time">Sample-Based Time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#audio-units">Audio Units</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decibels">Decibels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-rate">Bit Rate</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#device-types">Device Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-and-cuda">CPU and CUDA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#window-types">Window Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#window-functions">Window Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#window-characteristics">Window Characteristics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-specific-types">Filter-Specific Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-type">Filter Type</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-order-scale">Filter Order Scale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-types">Spectral Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectrogram-scale">Spectrogram Scale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#type-annotations-in-custom-effects">Type Annotations in Custom Effects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices">Best Practices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-musical-time-for-rhythmic-effects">Use Musical Time for Rhythmic Effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-type-constraints">Validate Type Constraints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#document-units-in-docstrings">Document Units in Docstrings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-conversions">Common Conversions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bpm-to-time">BPM to Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#samples-to-time">Samples to Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amplitude-to-decibels">Amplitude to Decibels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#related-concepts">Related Concepts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#external-resources">External Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/matteospanio/torchfx/edit/main/docs/source/guides/core-concepts/type-system.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/guides/core-concepts/type-system.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Matteo Spanio.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>