
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Filters &#8212; TorchFX 1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=6f8f3740"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/filters';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Effects" href="effects.html" />
    <link rel="prev" title="Core Classes" href="core.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" /> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/index/atom.xml"
  title="TorchFX Blog"
/>
  
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/tfx_black.svg" class="logo__image only-light" alt=""/>
    <img src="../_static/tfx.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">TorchFX</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guides/index.html">
    Guides
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog/index.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matteospanio/torchfx" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchfx/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guides/index.html">
    Guides
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog/index.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matteospanio/torchfx" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchfx/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core Classes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="effects.html">Effects</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Filters</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section id="filters">
<h1>Filters<a class="headerlink" href="#filters" title="Link to this heading">#</a></h1>
<p>TorchFX provides a comprehensive collection of IIR and FIR filters for audio processing.</p>
<section id="base-classes">
<h2>Base Classes<a class="headerlink" href="#base-classes" title="Link to this heading">#</a></h2>
<section id="iir">
<h3>IIR<a class="headerlink" href="#iir" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.IIR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">IIR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#IIR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.IIR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFilter</span></code></p>
<p>Base class for Infinite Impulse Response (IIR) filters.</p>
<p>This abstract class provides the foundation for all IIR filter implementations
in torchfx. It implements lazy coefficient computation, automatic device
management, and the core filtering operation using <cite>torchaudio.functional.lfilter</cite>.</p>
<p>IIR filters are recursive digital filters characterized by their transfer
function H(z) = B(z)/A(z), where B(z) are the feedforward (numerator)
coefficients and A(z) are the feedback (denominator) coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.IIR.fs">
<span class="sig-name descname"><span class="pre">fs</span></span><a class="headerlink" href="#torchfx.filter.IIR.fs" title="Link to this definition">#</a></dt>
<dd><p>The sampling frequency in Hz. Initially None until set from input signal
or manually configured.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.IIR.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#torchfx.filter.IIR.cutoff" title="Link to this definition">#</a></dt>
<dd><p>The cutoff frequency in Hz. For different filter types, this may represent
the -3dB point, center frequency, or transition frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.IIR.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#torchfx.filter.IIR.a" title="Link to this definition">#</a></dt>
<dd><p>Denominator (feedback) coefficients of the filter transfer function.
None until computed via <cite>compute_coefficients()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>] | Tensor | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.IIR.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#torchfx.filter.IIR.b" title="Link to this definition">#</a></dt>
<dd><p>Numerator (feedforward) coefficients of the filter transfer function.
None until computed via <cite>compute_coefficients()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>] | Tensor | None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<dl class="simple">
<dt>Coefficient Computation Flow:</dt><dd><ol class="arabic simple">
<li><p>Filter is instantiated with parameters (fs may be None)</p></li>
<li><p>On first forward pass, if coefficients are None, compute_coefficients() is called</p></li>
<li><p>Coefficients are converted to tensors and moved to input device</p></li>
<li><p>Filtering is performed using lfilter from torchaudio</p></li>
</ol>
</dd>
</dl>
<p>The lazy evaluation pattern minimizes memory usage when filters are instantiated
but not immediately used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbstractFilter</span></code></dt><dd><p>Base class for all filters</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.FIR" title="torchfx.filter.fir.FIR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torchfx.filter.fir.FIR</span></code></a></dt><dd><p>Base class for FIR filters</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.IIR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#IIR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.IIR.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>Tensor</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.IIR.move_coeff">
<span class="sig-name descname"><span class="pre">move_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#IIR.move_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.IIR.move_coeff" title="Link to this definition">#</a></dt>
<dd><p>Move the filter coefficients to the specified device and dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'cpu'</em><em>, </em><em>'cuda'</em><em>] </em><em>| </em><em>~torch.device</em>)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.9)"><em>dtype</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="fir-filters">
<h2>FIR Filters<a class="headerlink" href="#fir-filters" title="Link to this heading">#</a></h2>
<section id="fir">
<h3>FIR<a class="headerlink" href="#fir" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.FIR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">FIR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#FIR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.FIR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFilter</span></code></p>
<p>Efficient FIR filter implementation using PyTorch conv1d operation.</p>
<p>The <cite>FIR</cite> class implements a basic Finite Impulse Response filter that accepts
pre-computed filter coefficients and applies them using PyTorch’s optimized
<cite>conv1d</cite> operation. This provides GPU-accelerated filtering with automatic
device management and support for mono, stereo, and batched audio processing.</p>
<p>FIR filters are always stable (no feedback) and can provide linear phase response
when designed with symmetric coefficients. This class serves as the base for
<cite>DesignableFIR</cite> and can also be used directly when you have custom-designed
coefficients from external tools or algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> (<em>array_like</em>) – FIR filter coefficients (numerator). Can be a Python list, NumPy array,
or any array-like object. The coefficients define the filter’s impulse
response. Length determines filter order (num_taps = len(b)).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.FIR.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><a class="headerlink" href="#torchfx.filter.FIR.kernel" title="Link to this definition">#</a></dt>
<dd><p>Registered buffer containing the flipped filter coefficients in shape [1, 1, K]
where K is the number of taps. The buffer is automatically moved to the input
tensor’s device during forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.FIR.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#torchfx.filter.FIR.a" title="Link to this definition">#</a></dt>
<dd><p>Denominator coefficients, always [1.0] for FIR filters (no feedback).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Shape</span> <span class="pre">Support</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-------------</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">The</span> <span class="pre">forward</span> <span class="pre">pass</span> <span class="pre">supports</span> <span class="pre">three</span> <span class="pre">input</span> <span class="pre">tensor</span> <span class="pre">shapes</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">[T]</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mono audio, single channel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">[C,</span> <span class="pre">T]</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Multi-channel audio (e.g., stereo where C=2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">[B,</span> <span class="pre">C,</span> <span class="pre">T]</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batched multi-channel audio</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Output</span> <span class="pre">shape</span> <span class="pre">matches</span> <span class="pre">input</span> <span class="pre">shape</span> <span class="pre">exactly.</span> <span class="pre">Time</span> <span class="pre">dimension</span> <span class="pre">T</span> <span class="pre">is</span> <span class="pre">preserved</span> <span class="pre">through</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">appropriate</span> <span class="pre">padding.</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Implementation</span> <span class="pre">Details</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">----------------------</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Convolution-Based</span> <span class="pre">Filtering**</span></span></dt>
<dd><p>Uses PyTorch’s <cite>conv1d</cite> with grouped convolution where each channel is
filtered independently with the same kernel. This is equivalent to applying
the FIR filter to each channel separately but is much more efficient.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Kernel</span> <span class="pre">Flipping**</span></span></dt>
<dd><p>Coefficients are flipped (reversed) before storage to ensure causal
convolution behavior compatible with <cite>scipy.signal.lfilter</cite>. This means
the first coefficient in <cite>b</cite> corresponds to the current sample, the second
to the previous sample, etc.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Padding</span> <span class="pre">Strategy**</span></span></dt>
<dd><p>Right-side padding of (K-1) samples is applied where K is the number of taps.
This maintains the original signal length and ensures causal filtering (no
future samples influence past outputs).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Device</span> <span class="pre">Management**</span></span></dt>
<dd><p>The kernel buffer is automatically moved to match the input tensor’s device
and dtype. No manual device management is required.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*No</span> <span class="pre">Gradient</span> <span class="pre">Computation**</span></span></dt>
<dd><p>All filtering operations execute under <cite>&#64;torch.no_grad()</cite> context since FIR
filters have fixed coefficients (not trainable parameters).</p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.DesignableFIR" title="torchfx.filter.DesignableFIR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DesignableFIR</span></code></a></dt><dd><p>FIR filter with automatic coefficient design via window method</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torchfx.filter.iir.IIR</span></code></a></dt><dd><p>IIR filter base class for comparison</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbstractFilter</span></code></dt><dd><p>Base class for all filters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.lfilter</span></code></dt><dd><p>Compatible filtering function in SciPy</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt><strong>Linear Phase Property</strong>:</dt><dd><p>If coefficients are symmetric (b[i] = b[N-1-i]), the filter has linear phase,
meaning constant group delay across all frequencies. This preserves waveform
shape without phase distortion, critical for audio mastering and measurement.</p>
</dd>
<dt><strong>Stability</strong>:</dt><dd><p>FIR filters are always BIBO (Bounded Input Bounded Output) stable because
they have no poles (denominator is always 1). This makes them suitable for
applications where stability is critical.</p>
</dd>
<dt><strong>Computational Complexity</strong>:</dt><dd><p>Time complexity is O(N × K) where N is signal length and K is number of taps.
Space complexity is O(K) for kernel storage plus O(N) for padded input.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>For comprehensive FIR filter theory and design patterns, see wiki/4.2 FIR Filters.md.</p>
<p>For implementation details and performance characteristics, see the “Implementation
Details” section in wiki/4.2 FIR Filters.md.</p>
<p class="rubric">Examples</p>
<p>Basic moving average filter (5-tap):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.filter</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIR</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define coefficients for simple moving average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ma_filter</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to mono signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothed</span> <span class="o">=</span> <span class="n">ma_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">smoothed</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([44100])</span>
</pre></div>
</div>
<p>Custom FIR coefficients from external design:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design filter using scipy directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">taps</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use coefficients in torchfx FIR filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">taps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to audio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">fir</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
</pre></div>
</div>
<p>Processing stereo audio [C, T]:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Stereo signal with 2 channels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stereo</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter applies same coefficients to both channels independently</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>  <span class="c1"># Simple 3-tap filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_stereo</span> <span class="o">=</span> <span class="n">fir</span><span class="p">(</span><span class="n">stereo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_stereo</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([2, 44100])</span>
</pre></div>
</div>
<p>Batch processing [B, C, T]:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch of 8 stereo signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply filter to entire batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_batch</span> <span class="o">=</span> <span class="n">fir</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([8, 2, 44100])</span>
</pre></div>
</div>
<p>GPU acceleration:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Move input to GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal_gpu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter automatically runs on GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_gpu</span> <span class="o">=</span> <span class="n">fir</span><span class="p">(</span><span class="n">signal_gpu</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_gpu</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>
</pre></div>
</div>
<p>Designing a differentiator FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Differentiator approximates derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3-tap differentiator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_filter</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">derivative</span> <span class="o">=</span> <span class="n">diff_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Output approximates cosine</span>
</pre></div>
</div>
<p>Hilbert transformer for analytic signal:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design Hilbert transformer (90-degree phase shift)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a simplified example - real Hilbert needs more taps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">hilbert</span> <span class="k">as</span> <span class="n">scipy_hilbert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">impulse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">impulse</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analytic</span> <span class="o">=</span> <span class="n">scipy_hilbert</span><span class="p">(</span><span class="n">impulse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hilbert_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">analytic</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create FIR filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hilbert_fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">hilbert_coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to get quadrature component</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quadrature</span> <span class="o">=</span> <span class="n">hilbert_fir</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<p>Using with torchfx.Wave pipeline:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load audio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design custom FIR coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>  <span class="c1"># Simple lowpass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply in pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">fir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;filtered.wav&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Cascading multiple FIR filters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design two FIR filters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir1</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>  <span class="c1"># First smoothing stage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir2</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>  <span class="c1"># Second smoothing stage</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Cascade them (equivalent to convolving coefficients)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">fir2</span><span class="p">(</span><span class="n">fir1</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or use pipeline syntax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">fir1</span> <span class="o">|</span> <span class="n">fir2</span>
</pre></div>
</div>
<p>Verifying filter stability (always stable for FIR):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># FIR filters are always stable because denominator a = [1.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [1.0] - no feedback, always stable</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Even with arbitrary coefficients, FIR is stable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unstable_looking</span> <span class="o">=</span> <span class="n">FIR</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unstable_looking</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># Still [1.0] - stable</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.FIR.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#FIR.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.FIR.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.FIR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#FIR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.FIR.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>Tensor</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="designablefir">
<h3>DesignableFIR<a class="headerlink" href="#designablefir" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">DesignableFIR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_taps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hamming'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#DesignableFIR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.DesignableFIR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.FIR" title="torchfx.filter.fir.FIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">FIR</span></code></a></p>
<p>FIR filter with automatic coefficient design using the window method.</p>
<p><cite>DesignableFIR</cite> extends the base <cite>FIR</cite> class by automatically computing filter
coefficients using the windowed Fourier series method via <cite>scipy.signal.firwin</cite>.
Instead of providing pre-computed coefficients, you specify the desired filter
characteristics (cutoff frequency, number of taps, window type) and the class
designs the filter for you.</p>
<p>This class is ideal for standard filtering tasks (lowpass, highpass, bandpass,
bandstop) where you don’t need custom coefficient design. The window method
provides intuitive trade-offs between transition bandwidth and stopband attenuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>]</em>) – <p>Cutoff frequency or frequencies in Hz. The interpretation depends on the
number of cutoff values provided:</p>
<ul>
<li><p>Single value with pass_zero=True: Lowpass filter</p></li>
<li><p>Single value with pass_zero=False: Highpass filter</p></li>
<li><p>Two values [low, high] with pass_zero=False: Bandpass filter (low to high)</p></li>
<li><p>Two values [low, high] with pass_zero=True: Bandstop filter (notch low to high)</p></li>
</ul>
</p></li>
<li><p><strong>num_taps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – <p>Number of filter taps (coefficients). Must be odd for type I FIR filters.
Higher values provide sharper frequency transitions but increase computational
cost and latency. Typical values:</p>
<ul>
<li><p>51-101: Fast, moderate selectivity</p></li>
<li><p>101-201: Balanced, good selectivity</p></li>
<li><p>201-501: Excellent selectivity, higher latency</p></li>
</ul>
</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Sampling frequency in Hz. If None, the filter coefficients are not computed
during initialization. The sampling frequency can be set later via the <cite>fs</cite>
attribute or automatically when used in a pipeline with <cite>Wave</cite> objects.
Default is None.</p></li>
<li><p><strong>pass_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>Controls the filter type when a single cutoff is provided:</p>
<ul>
<li><p>True: Lowpass (gain of 1 at DC, passes zero frequency)</p></li>
<li><p>False: Highpass (gain of 0 at DC, blocks zero frequency)</p></li>
</ul>
<p>For two cutoff frequencies:</p>
<ul>
<li><p>True: Bandstop (notch filter)</p></li>
<li><p>False: Bandpass</p></li>
</ul>
<p>Default is True (lowpass).</p>
</p></li>
<li><p><strong>window</strong> (<em>WindowType</em><em>, </em><em>optional</em>) – <p>Window function to apply during filter design. Controls the trade-off between
main lobe width (transition bandwidth) and side lobe attenuation (stopband
ripple). Common options:</p>
<ul>
<li><p>”hamming”: Good general-purpose window (-43 dB sidelobes)</p></li>
<li><p>”hann”: Smooth transitions (-31 dB sidelobes)</p></li>
<li><p>”blackman”: Excellent stopband rejection (-58 dB sidelobes)</p></li>
<li><p>”kaiser”: Adjustable characteristics (requires beta parameter)</p></li>
<li><p>”bartlett”: Triangular window (-25 dB sidelobes)</p></li>
</ul>
<p>Default is “hamming”.</p>
</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.cutoff" title="Link to this definition">#</a></dt>
<dd><p>Stored cutoff frequency or frequencies in Hz.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or Sequence[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.num_taps">
<span class="sig-name descname"><span class="pre">num_taps</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.num_taps" title="Link to this definition">#</a></dt>
<dd><p>Stored number of filter taps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.fs">
<span class="sig-name descname"><span class="pre">fs</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.fs" title="Link to this definition">#</a></dt>
<dd><p>Sampling frequency in Hz. Initially None until set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.pass_zero">
<span class="sig-name descname"><span class="pre">pass_zero</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.pass_zero" title="Link to this definition">#</a></dt>
<dd><p>Stored pass_zero parameter controlling filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.window">
<span class="sig-name descname"><span class="pre">window</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.window" title="Link to this definition">#</a></dt>
<dd><p>Stored window function type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>WindowType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.b" title="Link to this definition">#</a></dt>
<dd><p>Computed filter coefficients (numerator). None until <cite>compute_coefficients()</cite>
is called, which happens automatically on first use or when <cite>fs</cite> is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.kernel" title="Link to this definition">#</a></dt>
<dd><p>Inherited from <cite>FIR</cite>. Registered buffer containing flipped coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#torchfx.filter.DesignableFIR.a" title="Link to this definition">#</a></dt>
<dd><p>Inherited from <cite>FIR</cite>. Always [1.0] for FIR filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.DesignableFIR.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#DesignableFIR.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.DesignableFIR.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Computes FIR filter coefficients using <cite>scipy.signal.firwin</cite> and initializes
the parent <cite>FIR</cite> class with the computed coefficients. Called automatically
when <cite>fs</cite> is set and coefficients haven’t been computed yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Window</span> <span class="pre">Method</span> <span class="pre">Theory</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">--------------------</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">The</span> <span class="pre">window</span> <span class="pre">method</span> <span class="pre">designs</span> <span class="pre">FIR</span> <span class="pre">filters</span> <span class="pre">by:</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">1.</span> <span class="pre">Starting</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">ideal</span> <span class="pre">frequency</span> <span class="pre">response</span> <span class="pre">(infinite</span> <span class="pre">impulse</span> <span class="pre">response)</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">2.</span> <span class="pre">Applying</span> <span class="pre">inverse</span> <span class="pre">Fourier</span> <span class="pre">transform</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">time-domain</span> <span class="pre">impulse</span> <span class="pre">response</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">3.</span> <span class="pre">Truncating</span> <span class="pre">to</span> <span class="pre">finite</span> <span class="pre">length</span> <span class="pre">(num_taps</span> <span class="pre">samples)</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">4.</span> <span class="pre">Applying</span> <span class="pre">a</span> <span class="pre">window</span> <span class="pre">function</span> <span class="pre">to</span> <span class="pre">reduce</span> <span class="pre">Gibbs</span> <span class="pre">phenomenon</span> <span class="pre">(ripple)</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Different</span> <span class="pre">window</span> <span class="pre">functions</span> <span class="pre">provide</span> <span class="pre">different</span> <span class="pre">trade-offs:</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">**Narrow</span> <span class="pre">main</span> <span class="pre">lobe**</span> <span class="pre">(e.g.,</span> <span class="pre">rectangular):</span> <span class="pre">Sharp</span> <span class="pre">transitions</span> <span class="pre">but</span> <span class="pre">high</span> <span class="pre">ripple</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">**Wide</span> <span class="pre">main</span> <span class="pre">lobe**</span> <span class="pre">(e.g.,</span> <span class="pre">Blackman):</span> <span class="pre">Smooth</span> <span class="pre">transitions,</span> <span class="pre">low</span> <span class="pre">ripple</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">**Medium**</span> <span class="pre">(e.g.,</span> <span class="pre">Hamming,</span> <span class="pre">Hann):</span> <span class="pre">Balanced</span> <span class="pre">trade-off</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Design</span> <span class="pre">Guidelines</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-----------------</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Choosing</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">Taps**:</span></span></dt>
<dd><p>Rule of thumb for transition bandwidth Δf at sampling rate fs:</p>
<blockquote>
<div><p>num_taps ≈ (stopband_atten_dB / 22) * (fs / Δf)</p>
</div></blockquote>
<p>For example, -60 dB stopband attenuation with 1000 Hz transition at 44100 Hz:</p>
<blockquote>
<div><p>num_taps ≈ (60 / 22) * (44100 / 1000) ≈ 120</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Choosing</span> <span class="pre">Window</span> <span class="pre">Type**:</span></span></dt>
<dd><ul class="simple">
<li><p>Hamming: Good default for most applications</p></li>
<li><p>Hann: When smooth transitions are more important than stopband rejection</p></li>
<li><p>Blackman: When maximum stopband rejection is critical (audio mastering)</p></li>
<li><p>Kaiser: When you need precise control over specifications</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*Linear</span> <span class="pre">Phase</span> <span class="pre">Property**:</span></span></dt>
<dd><p>All filters designed by this class have linear phase (constant group delay)
because the window method produces symmetric coefficients. Group delay is:</p>
<blockquote>
<div><p>group_delay = (num_taps - 1) / (2 * fs) seconds</p>
</div></blockquote>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.FIR" title="torchfx.filter.FIR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FIR</span></code></a></dt><dd><p>Base FIR filter class accepting pre-computed coefficients</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.iir.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torchfx.filter.iir.Butterworth</span></code></a></dt><dd><p>IIR alternative for comparison</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.firwin</span></code></dt><dd><p>Underlying filter design function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.freqz</span></code></dt><dd><p>Analyze designed filter frequency response</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<dl>
<dt><strong>Computational Cost vs IIR</strong>:</dt><dd><p>FIR filters typically require 10-100x more taps than equivalent IIR filters
for similar frequency selectivity. However, FIR filters guarantee stability
and can provide linear phase, which IIR filters cannot (except at specific
frequencies).</p>
</dd>
<dt><strong>Odd vs Even Tap Count</strong>:</dt><dd><p>For most filter types, use odd number of taps. Even tap counts can be used
but may not have zero-phase at Nyquist frequency for certain filter types.</p>
</dd>
<dt><strong>Frequency Response Analysis</strong>:</dt><dd><p>Use <cite>scipy.signal.freqz</cite> to visualize the designed filter’s frequency response:</p>
<blockquote>
<div><p>from scipy.signal import freqz
w, h = freqz(filter.b, worN=8000, fs=filter.fs)
plt.plot(w, 20*np.log10(abs(h)))</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">References</p>
<p>For comprehensive filter design examples and window function comparisons,
see wiki/4.2 FIR Filters.md.</p>
<p>For API reference and parameter details, see wiki/8.3 torchfx.filter.md.</p>
<p>For guidance on choosing between FIR and IIR filters, see wiki/4 Filters.md.</p>
<p class="rubric">Examples</p>
<p>Basic lowpass filter design:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchfx.filter</span><span class="w"> </span><span class="kn">import</span> <span class="n">DesignableFIR</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design lowpass at 5 kHz with default Hamming window</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to mono signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">lpf</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([44100])</span>
</pre></div>
</div>
<p>Highpass filter to remove low-frequency rumble:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove frequencies below 100 Hz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>  <span class="c1"># Higher taps for sharp low-frequency cutoff</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Highpass</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="s2">&quot;blackman&quot;</span>  <span class="c1"># High stopband rejection</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to audio with DC offset and rumble</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">hpf</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
</pre></div>
</div>
<p>Bandpass filter for voice frequencies:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract telephone bandwidth (300-3400 Hz)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bpf</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="p">[</span><span class="mf">300.0</span><span class="p">,</span> <span class="mf">3400.0</span><span class="p">],</span>  <span class="c1"># Two cutoffs</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Bandpass</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to speech signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">speech</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">telephone_quality</span> <span class="o">=</span> <span class="n">bpf</span><span class="p">(</span><span class="n">speech</span><span class="p">)</span>
</pre></div>
</div>
<p>Bandstop (notch) filter to remove interference:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove 50-70 Hz hum band (European power line + harmonics)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="p">[</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">301</span><span class="p">,</span>  <span class="c1"># High order for narrow notch</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Bandstop</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="s2">&quot;blackman&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply to remove power line interference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noisy</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">notch</span><span class="p">(</span><span class="n">noisy</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparing different window types:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">freqz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design same filter with different windows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windows</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;hamming&quot;</span><span class="p">:</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;hann&quot;</span><span class="p">:</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;blackman&quot;</span><span class="p">:</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;blackman&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot frequency responses</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fir</span> <span class="ow">in</span> <span class="n">windows</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Magnitude (dB)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Window Function Comparison&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Exploring the effect of tap count:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Low, medium, high tap counts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir_51</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir_101</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir_201</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare frequency responses</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">freqz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">taps</span><span class="p">,</span> <span class="n">fir</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">51</span><span class="p">,</span> <span class="n">fir_51</span><span class="p">),</span> <span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="n">fir_101</span><span class="p">),</span> <span class="p">(</span><span class="mi">201</span><span class="p">,</span> <span class="n">fir_201</span><span class="p">)]:</span>
<span class="gp">... </span>    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">taps</span><span class="si">}</span><span class="s2"> taps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Magnitude (dB)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Effect of Tap Count on Transition Bandwidth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Deferred coefficient computation (fs=None):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create filter without computing coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># None - coefficients not computed yet</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set sampling frequency later</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">44100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span><span class="o">.</span><span class="n">compute_coefficients</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># True - coefficients now computed</span>
</pre></div>
</div>
<p>Using with torchfx.Wave pipeline (automatic fs configuration):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load audio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>  <span class="c1"># wave.fs = 44100</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create filter without fs - will be set from wave</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lpf</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>  <span class="c1"># None</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply using pipe operator - fs set automatically</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lpf</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>  <span class="c1"># 44100 - set from wave</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;filtered.wav&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Anti-aliasing filter before downsampling:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Downsample from 44100 Hz to 22050 Hz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design anti-aliasing filter at 0.4 * new_rate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anti_alias</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">*</span> <span class="mi">22050</span><span class="p">,</span>  <span class="c1"># 8820 Hz</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="s2">&quot;blackman&quot;</span>  <span class="c1"># High stopband attenuation</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter then downsample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">anti_alias</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">downsampled</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Decimate by factor of 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">downsampled</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([22050])</span>
</pre></div>
</div>
<p>Multi-band processing with multiple DesignableFIR filters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create 3-band crossover</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Process each band separately</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low_band</span> <span class="o">=</span> <span class="n">low</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid_band</span> <span class="o">=</span> <span class="n">mid</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high_band</span> <span class="o">=</span> <span class="n">high</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply different processing to each band, then recombine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (processing steps omitted for brevity)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mixed</span> <span class="o">=</span> <span class="n">low_band</span> <span class="o">+</span> <span class="n">mid_band</span> <span class="o">+</span> <span class="n">high_band</span>
</pre></div>
</div>
<p>GPU acceleration:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create signal on GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal_gpu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter automatically runs on GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_gpu</span> <span class="o">=</span> <span class="n">fir</span><span class="p">(</span><span class="n">signal_gpu</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_gpu</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>
</pre></div>
</div>
<p>Batch processing stereo audio:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch of 8 stereo signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply same filter to all signals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_batch</span> <span class="o">=</span> <span class="n">lpf</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([8, 2, 44100])</span>
</pre></div>
</div>
<p>Verifying linear phase property:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Design filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fir</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check coefficient symmetry (implies linear phase)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_symmetric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">is_symmetric</span><span class="p">)</span>  <span class="c1"># True - linear phase</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate group delay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_delay</span> <span class="o">=</span> <span class="p">(</span><span class="n">fir</span><span class="o">.</span><span class="n">num_taps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fir</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group delay: </span><span class="si">{</span><span class="n">group_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>  <span class="c1"># Constant for all frequencies</span>
</pre></div>
</div>
<p>Cascading filters for sharper rolloff:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Two cascaded filters provide steeper rolloff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf1</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf2</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply in series</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">lpf2</span><span class="p">(</span><span class="n">lpf1</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or use pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf1</span> <span class="o">|</span> <span class="n">lpf2</span>
</pre></div>
</div>
<p>Custom window with parameters (Kaiser window):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Kaiser window allows precise specification of stopband attenuation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># beta parameter controls trade-off: higher beta = more attenuation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kaiser_fir</span> <span class="o">=</span> <span class="n">DesignableFIR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_taps</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;kaiser&quot;</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>  <span class="c1"># Tuple: (name, beta)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">kaiser_fir</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/fir.html#DesignableFIR.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="iir-filters">
<h2>IIR Filters<a class="headerlink" href="#iir-filters" title="Link to this heading">#</a></h2>
<section id="standard-filters">
<h3>Standard Filters<a class="headerlink" href="#standard-filters" title="Link to this heading">#</a></h3>
<section id="butterworth">
<h4>Butterworth<a class="headerlink" href="#butterworth" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.Butterworth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">Butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">btype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Butterworth" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Butterworth filter with maximally flat passband response.</p>
<p>Butterworth filters provide the smoothest possible passband response with no
ripple in either passband or stopband. They offer a good balance between
frequency selectivity and phase linearity, making them ideal for general-purpose
audio filtering applications.</p>
<p>The filter has a monotonic frequency response with -3 dB gain at the cutoff
frequency. The rolloff steepness is determined by the filter order, with higher
orders providing sharper transitions at the cost of increased phase distortion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filter type. One of:
- “lowpass”: Passes frequencies below cutoff
- “highpass”: Passes frequencies above cutoff
- “bandpass”: Passes frequencies within a band
- “bandstop”: Rejects frequencies within a band</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. This is the -3 dB point for lowpass/highpass filters.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher orders provide steeper rolloff but increased phase
distortion. The rolloff rate is approximately 6 * order dB per octave.
Typical values: 2-8 for audio applications.</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode:
- “linear”: Use order value directly
- “db”: Divide order by 6 (useful for octave-based specifications)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz. If None, will be set automatically from the
input signal.</p></li>
<li><p><strong>a</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>default=None</em>) – Pre-computed denominator coefficients. If provided, coefficient computation
is skipped.</p></li>
<li><p><strong>b</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>default=None</em>) – Pre-computed numerator coefficients. If provided, coefficient computation
is skipped.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Butterworth.btype">
<span class="sig-name descname"><span class="pre">btype</span></span><a class="headerlink" href="#torchfx.filter.Butterworth.btype" title="Link to this definition">#</a></dt>
<dd><p>The filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Butterworth.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#torchfx.filter.Butterworth.order" title="Link to this definition">#</a></dt>
<dd><p>The effective filter order (after scaling).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Low-pass filter at 1 kHz with 4th order:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Butterworth</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>High-pass filter to remove subsonic frequencies:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Butterworth</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Comparing different orders (steeper rolloff with higher order):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2nd order: gentle 12 dB/octave rolloff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf2</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Butterworth</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 8th order: steep 48 dB/octave rolloff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf8</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Butterworth</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Frequency Response Characteristics:</dt><dd><ul class="simple">
<li><p>Passband: Maximally flat (no ripple)</p></li>
<li><p>Stopband: Monotonic rolloff, no ripple</p></li>
<li><p>-3 dB point: Exactly at cutoff frequency</p></li>
<li><p>Rolloff rate: ~6 * order dB/octave in stopband</p></li>
<li><p>Phase response: Nonlinear (increases with order)</p></li>
</ul>
</dd>
</dl>
<p>The Butterworth filter is designed to have a frequency response magnitude that
is as flat as possible in the passband. The squared magnitude response is:</p>
<blockquote>
<div><p><a href="#id1"><span class="problematic" id="id2">|</span></a>H(jω)|² = 1 / (1 + (ω/ωc)^(2n))</p>
</div></blockquote>
<p>where n is the filter order and ωc is the cutoff frequency.</p>
<p>For audio applications, orders 2-4 are common for gentle filtering, while
orders 6-8 provide sharper transitions. Very high orders (&gt;12) may exhibit
numerical instability.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Butterworth, S. (1930). “On the Theory of Filter Amplifiers”.
Wireless Engineer, 7: 536-541.</p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiButterworth" title="torchfx.filter.HiButterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiButterworth</span></code></a></dt><dd><p>High-pass Butterworth convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoButterworth" title="torchfx.filter.LoButterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoButterworth</span></code></a></dt><dd><p>Low-pass Butterworth convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.Chebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></dt><dd><p>Type 1 Chebyshev filter with passband ripple</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.Elliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elliptic</span></code></a></dt><dd><p>Elliptic filter with optimized rolloff</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.Butterworth.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Butterworth.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Butterworth.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="implementation-requirements">
<h5>Implementation Requirements<a class="headerlink" href="#implementation-requirements" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiButterworth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiButterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiButterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiButterworth" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.iir.Butterworth"><code class="xref py py-class docutils literal notranslate"><span class="pre">Butterworth</span></code></a></p>
<p>High-pass Butterworth filter convenience class.</p>
<p>This is a convenience class that creates a high-pass Butterworth filter
by automatically setting btype=”highpass”. Provides maximally flat response
in the passband with smooth rolloff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz (-3 dB point). Frequencies below this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=5</em>) – Filter order. Determines rolloff steepness (~6*order dB/octave).</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove DC offset and subsonic frequencies:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiButterworth</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Remove low-frequency rumble with gentle slope:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiButterworth</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Base Butterworth filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoButterworth" title="torchfx.filter.LoButterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoButterworth</span></code></a></dt><dd><p>Low-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoButterworth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoButterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoButterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoButterworth" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.iir.Butterworth"><code class="xref py py-class docutils literal notranslate"><span class="pre">Butterworth</span></code></a></p>
<p>Low-pass Butterworth filter convenience class.</p>
<p>This is a convenience class that creates a low-pass Butterworth filter
by automatically setting btype=”lowpass”. Provides maximally flat response
in the passband with smooth rolloff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz (-3 dB point). Frequencies above this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=5</em>) – Filter order. Determines rolloff steepness (~6*order dB/octave).</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove high-frequency noise:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoButterworth</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;noisy.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>Telephone bandwidth simulation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoButterworth</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3400</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;voice.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">telephone</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Base Butterworth filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiButterworth" title="torchfx.filter.HiButterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiButterworth</span></code></a></dt><dd><p>High-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="chebyshev-type-i">
<h4>Chebyshev Type I<a class="headerlink" href="#chebyshev-type-i" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">Chebyshev1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">btype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Chebyshev1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Chebyshev1" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Chebyshev Type I filter with equalized passband ripple.</p>
<p>Chebyshev Type I filters trade passband ripple for steeper rolloff compared to
Butterworth filters. They provide sharper transitions between passband and
stopband for a given filter order, making them suitable when aggressive
frequency selectivity is needed and some passband ripple is acceptable.</p>
<p>The filter exhibits equalized ripple in the passband (oscillates between 1 and
1-ε where ε is determined by the ripple parameter) and monotonic rolloff in the
stopband.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filter type. One of:
- “lowpass”: Passes frequencies below cutoff
- “highpass”: Passes frequencies above cutoff
- “bandpass”: Passes frequencies within a band
- “bandstop”: Rejects frequencies within a band</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. For lowpass/highpass, this is the frequency where
the response exits the ripple band and enters the stopband.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Determines both the number of ripples in the passband (order
ripples) and the rolloff steepness. Higher orders provide steeper rolloff.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB. Typical values:
- 0.01 dB: Minimal ripple, closer to Butterworth response
- 0.1 dB: Good balance (default)
- 0.5 dB: Noticeable ripple but very sharp rolloff
- 1.0 dB: Aggressive rolloff, significant passband distortion</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz. If None, will be set automatically from the
input signal.</p></li>
<li><p><strong>a</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>default=None</em>) – Pre-computed denominator coefficients.</p></li>
<li><p><strong>b</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>default=None</em>) – Pre-computed numerator coefficients.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev1.btype">
<span class="sig-name descname"><span class="pre">btype</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev1.btype" title="Link to this definition">#</a></dt>
<dd><p>The filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev1.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev1.order" title="Link to this definition">#</a></dt>
<dd><p>The filter order.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev1.ripple">
<span class="sig-name descname"><span class="pre">ripple</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev1.ripple" title="Link to this definition">#</a></dt>
<dd><p>Maximum passband ripple in dB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Low-pass filter with tight cutoff and minimal ripple:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev1</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>High-pass filter with aggressive rolloff:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev1</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ripple</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Comparing ripple settings (more ripple = steeper rolloff):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Minimal ripple: gentler rolloff, closer to Butterworth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cheby_gentle</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev1</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher ripple: steeper rolloff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cheby_steep</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev1</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Frequency Response Characteristics:</dt><dd><ul class="simple">
<li><p>Passband: Equalized ripple (oscillates between 0 and -ripple dB)</p></li>
<li><p>Stopband: Monotonic rolloff, no ripple</p></li>
<li><p>Transition: Sharper than Butterworth for same order</p></li>
<li><p>Phase response: More nonlinear than Butterworth</p></li>
</ul>
</dd>
</dl>
<p>The ripple parameter controls the trade-off between passband flatness and
rolloff steepness. Smaller ripple values produce responses closer to Butterworth,
while larger values provide sharper transitions at the cost of passband
distortion.</p>
<p>For audio applications where passband flatness is critical (e.g., mastering),
use small ripple values (0.01-0.1 dB). For aggressive filtering where some
passband coloration is acceptable (e.g., anti-aliasing), larger ripple values
(0.5-1.0 dB) provide better stopband attenuation.</p>
<p>The Chebyshev Type I response is defined by:</p>
<blockquote>
<div><p><a href="#id4"><span class="problematic" id="id5">|</span></a>H(jω)|² = 1 / (1 + ε² Tₙ²(ω/ωc))</p>
</div></blockquote>
<p>where Tₙ is the nth-order Chebyshev polynomial and ε is related to the ripple.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiChebyshev1" title="torchfx.filter.HiChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiChebyshev1</span></code></a></dt><dd><p>High-pass Chebyshev Type I convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoChebyshev1" title="torchfx.filter.LoChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoChebyshev1</span></code></a></dt><dd><p>Low-pass Chebyshev Type I convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.Chebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></dt><dd><p>Type II Chebyshev with stopband ripple</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Butterworth filter with no ripple</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.Elliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elliptic</span></code></a></dt><dd><p>Elliptic filter with ripple in both bands</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev1.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Chebyshev1.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Chebyshev1.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id6">
<h5>Implementation Requirements<a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiChebyshev1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiChebyshev1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiChebyshev1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiChebyshev1" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.iir.Chebyshev1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></p>
<p>High-pass Chebyshev Type I filter convenience class.</p>
<p>This is a convenience class that creates a high-pass Chebyshev Type I filter
by automatically setting btype=”highpass”. High-pass filters attenuate
frequencies below the cutoff while passing higher frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies below this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher values provide steeper rolloff.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove low-frequency rumble:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiChebyshev1</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.Chebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></dt><dd><p>Base Chebyshev Type I filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoChebyshev1" title="torchfx.filter.LoChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoChebyshev1</span></code></a></dt><dd><p>Low-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoChebyshev1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoChebyshev1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoChebyshev1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoChebyshev1" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.iir.Chebyshev1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></p>
<p>Low-pass Chebyshev Type I filter convenience class.</p>
<p>This is a convenience class that creates a low-pass Chebyshev Type I filter
by automatically setting btype=”lowpass”. Low-pass filters attenuate frequencies
above the cutoff while passing lower frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies above this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher values provide steeper rolloff.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Anti-aliasing filter before downsampling:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoChebyshev1</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.Chebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></dt><dd><p>Base Chebyshev Type I filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiChebyshev1" title="torchfx.filter.HiChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiChebyshev1</span></code></a></dt><dd><p>High-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="chebyshev-type-ii">
<h4>Chebyshev Type II<a class="headerlink" href="#chebyshev-type-ii" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">Chebyshev2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">btype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Chebyshev2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Chebyshev2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Chebyshev Type II filter with equalized stopband ripple.</p>
<p>Chebyshev Type II filters (also called inverse Chebyshev) have a monotonic
passband response and equalized ripple in the stopband. They offer a compromise
between Butterworth (no ripple anywhere) and Chebyshev Type I (passband ripple),
providing sharper rolloff than Butterworth while maintaining a clean passband.</p>
<p>The filter is characterized by a maximally flat passband (like Butterworth) but
with oscillations in the stopband that allow for steeper rolloff at a given order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filter type. One of:
- “lowpass”: Passes frequencies below cutoff
- “highpass”: Passes frequencies above cutoff
- “bandpass”: Passes frequencies within a band
- “bandstop”: Rejects frequencies within a band</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. This is the frequency where the monotonic passband
response transitions to the oscillating stopband.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher orders provide steeper rolloff and more stopband
oscillations.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Minimum stopband attenuation in dB. This specifies how much the stopband
oscillates above the final attenuation level. Typical values:
- 20 dB: Moderate stopband attenuation
- 40 dB: Good stopband attenuation (common default)
- 60 dB: Strong stopband attenuation
- 80 dB: Very strong stopband rejection</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz. If None, will be set automatically from the
input signal.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev2.btype">
<span class="sig-name descname"><span class="pre">btype</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev2.btype" title="Link to this definition">#</a></dt>
<dd><p>The filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev2.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev2.order" title="Link to this definition">#</a></dt>
<dd><p>The filter order.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev2.ripple">
<span class="sig-name descname"><span class="pre">ripple</span></span><a class="headerlink" href="#torchfx.filter.Chebyshev2.ripple" title="Link to this definition">#</a></dt>
<dd><p>Minimum stopband attenuation in dB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Low-pass filter with clean passband:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev2</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ripple</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>High-pass filter with strong stopband rejection:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev2</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ripple</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Anti-aliasing filter with very high stopband attenuation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aa_filter</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Chebyshev2</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">aa_filter</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Frequency Response Characteristics:</dt><dd><ul class="simple">
<li><p>Passband: Monotonic, maximally flat (no ripple)</p></li>
<li><p>Stopband: Equalized ripple, oscillates around final attenuation level</p></li>
<li><p>Transition: Sharper than Butterworth, less sharp than Type I Chebyshev</p></li>
<li><p>Phase response: Nonlinear, but often better than Type I</p></li>
</ul>
</dd>
<dt>Chebyshev Type II filters are ideal when you need:</dt><dd><ul class="simple">
<li><p>Clean passband (no frequency-dependent gain variations)</p></li>
<li><p>Sharper rolloff than Butterworth</p></li>
<li><p>Acceptance of stopband ripple (usually inaudible for audio)</p></li>
</ul>
</dd>
</dl>
<p>The ripple parameter in Type II filters has opposite meaning from Type I:
it specifies the minimum stopband attenuation rather than passband ripple.
Higher ripple values mean better stopband rejection but require steeper
transition bands.</p>
<dl class="simple">
<dt>For audio applications, Type II is often preferred over Type I because:</dt><dd><ul class="simple">
<li><p>Passband stays clean (no coloration of wanted frequencies)</p></li>
<li><p>Stopband ripple is usually irrelevant (already heavily attenuated)</p></li>
<li><p>Good compromise between Butterworth and Type I characteristics</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiChebyshev2" title="torchfx.filter.HiChebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiChebyshev2</span></code></a></dt><dd><p>High-pass Chebyshev Type II convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoChebyshev2" title="torchfx.filter.LoChebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoChebyshev2</span></code></a></dt><dd><p>Low-pass Chebyshev Type II convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.Chebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></dt><dd><p>Type I Chebyshev with passband ripple</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Butterworth filter with no ripple</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.Elliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elliptic</span></code></a></dt><dd><p>Elliptic filter with ripple in both bands</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.Chebyshev2.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Chebyshev2.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Chebyshev2.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id7">
<h5>Implementation Requirements<a class="headerlink" href="#id7" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiChebyshev2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiChebyshev2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiChebyshev2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiChebyshev2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.iir.Chebyshev2"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></p>
<p>High-pass Chebyshev Type II filter convenience class.</p>
<p>This is a convenience class that creates a high-pass Chebyshev Type II filter
by automatically setting btype=”highpass”. Provides clean passband with
stopband ripple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies below this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher values provide steeper rolloff.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Minimum stopband attenuation in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiChebyshev2</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.Chebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></dt><dd><p>Base Chebyshev Type II filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoChebyshev2" title="torchfx.filter.LoChebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoChebyshev2</span></code></a></dt><dd><p>Low-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoChebyshev2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoChebyshev2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoChebyshev2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoChebyshev2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.iir.Chebyshev2"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></p>
<p>Low-pass Chebyshev Type II filter convenience class.</p>
<p>This is a convenience class that creates a low-pass Chebyshev Type II filter
by automatically setting btype=”lowpass”. Provides clean passband with
stopband ripple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies above this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Higher values provide steeper rolloff.</p></li>
<li><p><strong>ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Minimum stopband attenuation in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoChebyshev2</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ripple</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.Chebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></dt><dd><p>Base Chebyshev Type II filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiChebyshev2" title="torchfx.filter.HiChebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiChebyshev2</span></code></a></dt><dd><p>High-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="elliptic">
<h4>Elliptic<a class="headerlink" href="#elliptic" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">Elliptic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">btype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passband_ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopband_attenuation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Elliptic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Elliptic" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Elliptic (Cauer) filter with optimal transition bandwidth.</p>
<p>Elliptic filters (also called Cauer filters) achieve the sharpest possible
transition between passband and stopband for a given filter order. They do this
by allowing equalized ripple in both the passband and stopband, making them
optimal when you need maximum frequency selectivity with minimum filter order.</p>
<dl class="simple">
<dt>Of all classical IIR filter types, elliptic filters provide:</dt><dd><ul class="simple">
<li><p>Steepest rolloff for a given order</p></li>
<li><p>Lowest order for given specifications</p></li>
<li><p>Most aggressive frequency separation</p></li>
</ul>
</dd>
<dt>However, they also have:</dt><dd><ul class="simple">
<li><p>Ripple in both passband and stopband</p></li>
<li><p>Most nonlinear phase response</p></li>
<li><p>Potential for passband coloration</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filter type:
- “lowpass”: Passes frequencies below cutoff
- “highpass”: Passes frequencies above cutoff
- “bandpass”: Passes frequencies within a band
- “bandstop”: Rejects frequencies within a band</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. This is the edge of the passband where ripple
transitions to stopband.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. For elliptic filters, even low orders provide steep rolloff.
Typical values: 3-6 for most applications.</p></li>
<li><p><strong>passband_ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB. Controls the amount of gain variation
allowed in the passband. Typical values:
- 0.01 dB: Minimal ripple, closer to Chebyshev Type II
- 0.1 dB: Good balance (default)
- 0.5 dB: More aggressive rolloff, noticeable ripple
- 1.0 dB: Very steep rolloff, significant passband distortion</p></li>
<li><p><strong>stopband_attenuation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=40</em>) – Minimum stopband attenuation in dB. Specifies how much the stopband is
attenuated below 0 dB. Typical values:
- 20 dB: Light attenuation
- 40 dB: Good attenuation (default)
- 60 dB: Strong attenuation
- 80+ dB: Very strong rejection</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic.btype">
<span class="sig-name descname"><span class="pre">btype</span></span><a class="headerlink" href="#torchfx.filter.Elliptic.btype" title="Link to this definition">#</a></dt>
<dd><p>The filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#torchfx.filter.Elliptic.order" title="Link to this definition">#</a></dt>
<dd><p>The filter order.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic.passband_ripple">
<span class="sig-name descname"><span class="pre">passband_ripple</span></span><a class="headerlink" href="#torchfx.filter.Elliptic.passband_ripple" title="Link to this definition">#</a></dt>
<dd><p>Maximum passband ripple in dB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic.stopband_attenuation">
<span class="sig-name descname"><span class="pre">stopband_attenuation</span></span><a class="headerlink" href="#torchfx.filter.Elliptic.stopband_attenuation" title="Link to this definition">#</a></dt>
<dd><p>Minimum stopband attenuation in dB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Steep low-pass filter for anti-aliasing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Elliptic</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>Aggressive high-pass filter with minimal order:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Elliptic</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Comparing ripple settings (more ripple = steeper rolloff):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Conservative: minimal passband ripple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellip_gentle</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Elliptic</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Aggressive: higher passband ripple for steeper transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellip_steep</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Elliptic</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
</pre></div>
</div>
<p>Very low order filter (3rd order elliptic can match 6th order Butterworth):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ellip3</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Elliptic</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Frequency Response Characteristics:</dt><dd><ul class="simple">
<li><p>Passband: Equalized ripple (oscillates between 0 and -ripple dB)</p></li>
<li><p>Stopband: Equalized ripple (oscillates around -attenuation dB)</p></li>
<li><p>Transition: Sharpest of all classical filters</p></li>
<li><p>Phase response: Highly nonlinear (worst of classical filters)</p></li>
</ul>
</dd>
<dt>Design Trade-offs:</dt><dd><ul class="simple">
<li><p>Increasing passband_ripple → Steeper transition</p></li>
<li><p>Increasing stopband_attenuation → Steeper transition</p></li>
<li><p>Increasing order → Steeper transition and more ripples</p></li>
<li><p>All three parameters are interdependent in the design</p></li>
</ul>
</dd>
<dt>When to Use Elliptic Filters:</dt><dd><p>✓ Need steepest possible rolloff
✓ Filter order is constrained (computational resources)
✓ Phase linearity is not critical
✓ Can tolerate some passband and stopband ripple
✓ Anti-aliasing before downsampling
✓ Interference rejection with narrow transition bands</p>
</dd>
<dt>When NOT to Use:</dt><dd><p>✗ Phase linearity is important (use FIR instead)
✗ Passband must be perfectly flat (use Butterworth)
✗ Critical listening applications (use Chebyshev Type II or Butterworth)</p>
</dd>
<dt>Comparison with other filters (for same specifications):</dt><dd><ul class="simple">
<li><p>Elliptic: Lowest order, steepest rolloff, ripple everywhere</p></li>
<li><p>Chebyshev I: Higher order, passband ripple only</p></li>
<li><p>Chebyshev II: Higher order, stopband ripple only</p></li>
<li><p>Butterworth: Highest order, no ripple, smoothest response</p></li>
</ul>
</dd>
</dl>
<p>The elliptic filter design is based on elliptic rational functions (Jacobi
elliptic functions), which allow the equiripple behavior in both bands. The
filter achieves optimal Chebyshev approximation in both passband and stopband
simultaneously.</p>
<p>Caution: Very high stopband attenuation requirements (&gt;80 dB) combined with
tight passband ripple (&lt;0.1 dB) may result in numerical instability or require
high filter orders.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Cauer, W., Mathis, W., &amp; Pauli, R. (2000). “Life and Work of Wilhelm Cauer.”
Proceedings of the Fourteenth International Symposium of Mathematical
Theory of Networks and Systems.</p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiElliptic" title="torchfx.filter.HiElliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiElliptic</span></code></a></dt><dd><p>High-pass elliptic convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoElliptic" title="torchfx.filter.LoElliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoElliptic</span></code></a></dt><dd><p>Low-pass elliptic convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev1" title="torchfx.filter.Chebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a></dt><dd><p>Type I Chebyshev with passband ripple only</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Chebyshev2" title="torchfx.filter.Chebyshev2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a></dt><dd><p>Type II Chebyshev with stopband ripple only</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Butterworth filter with no ripple</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.Elliptic.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Elliptic.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Elliptic.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id9">
<h5>Implementation Requirements<a class="headerlink" href="#id9" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiElliptic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiElliptic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passband_ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopband_attenuation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiElliptic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiElliptic" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.iir.Elliptic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elliptic</span></code></a></p>
<p>High-pass Elliptic filter convenience class.</p>
<p>This convenience class creates a high-pass elliptic filter by automatically
setting btype=”highpass”. Provides the steepest possible high-pass rolloff
for a given filter order, with ripple in both passband and stopband.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies below this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Even low orders (3-4) provide steep rolloff.</p></li>
<li><p><strong>passband_ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB.</p></li>
<li><p><strong>stopband_attenuation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=40</em>) – Minimum stopband attenuation in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Remove low frequencies with aggressive rolloff:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiElliptic</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<p>Low-order but steep filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiElliptic</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.Elliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elliptic</span></code></a></dt><dd><p>Base elliptic filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoElliptic" title="torchfx.filter.LoElliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoElliptic</span></code></a></dt><dd><p>Low-pass variant</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiChebyshev1" title="torchfx.filter.HiChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiChebyshev1</span></code></a></dt><dd><p>High-pass with passband ripple only</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoElliptic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoElliptic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passband_ripple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopband_attenuation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoElliptic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoElliptic" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.iir.Elliptic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elliptic</span></code></a></p>
<p>Low-pass Elliptic filter convenience class.</p>
<p>This convenience class creates a low-pass elliptic filter by automatically
setting btype=”lowpass”. Provides the steepest possible low-pass rolloff
for a given filter order, with ripple in both passband and stopband.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Cutoff frequency in Hz. Frequencies above this are attenuated.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Even low orders (3-4) provide steep rolloff.</p></li>
<li><p><strong>passband_ripple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Maximum passband ripple in dB.</p></li>
<li><p><strong>stopband_attenuation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>default=40</em>) – Minimum stopband attenuation in dB.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Steep anti-aliasing filter before downsampling:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoElliptic</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<p>Minimal order noise reduction:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoElliptic</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">passband_ripple</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">stopband_attenuation</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;noisy.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.Elliptic" title="torchfx.filter.Elliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Elliptic</span></code></a></dt><dd><p>Base elliptic filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiElliptic" title="torchfx.filter.HiElliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiElliptic</span></code></a></dt><dd><p>High-pass variant</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoChebyshev1" title="torchfx.filter.LoChebyshev1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoChebyshev1</span></code></a></dt><dd><p>Low-pass with passband ripple only</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="linkwitz-riley">
<h4>Linkwitz-Riley<a class="headerlink" href="#linkwitz-riley" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LinkwitzRiley">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LinkwitzRiley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">btype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LinkwitzRiley"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LinkwitzRiley" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Linkwitz-Riley crossover filter for speaker systems.</p>
<p>Linkwitz-Riley filters are designed specifically for crossover applications where
audio is split into multiple frequency bands for different speakers (e.g., woofer,
tweeter). They are created by cascading two identical Butterworth filters, resulting
in several desirable properties:</p>
<ol class="arabic simple">
<li><p>-6 dB gain at the cutoff frequency for both high-pass and low-pass sections</p></li>
<li><p>Flat magnitude response when high-pass and low-pass outputs are summed</p></li>
<li><p>Zero phase difference between outputs at crossover frequency</p></li>
<li><p>Complementary magnitude responses</p></li>
</ol>
<p>These properties make Linkwitz-Riley filters ideal for multi-way speaker systems,
ensuring smooth transitions between drivers with no amplitude or phase anomalies.</p>
<p>The filter order must be an even integer (2, 4, 8, etc.) because it’s formed by
cascading two Butterworth filters. The effective order is twice that of each
Butterworth stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>btype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Filter type: “lowpass” or “highpass”. For crossover applications, use
matching pairs of low-pass and high-pass filters at the same frequency.</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Crossover frequency in Hz. This is where both the low-pass and high-pass
filters will be at -6 dB. Common crossover frequencies:
- 80-120 Hz: Subwoofer crossover
- 200-500 Hz: Woofer-midrange crossover
- 2000-3500 Hz: Midrange-tweeter crossover</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order. Must be a positive even integer (2, 4, 8, 12, etc.).
Common orders:
- 2nd order (12 dB/octave): Gentle slope, good phase
- 4th order (24 dB/octave): Standard for many systems
- 8th order (48 dB/octave): Steep slope for problem drivers</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.LinkwitzRiley.btype">
<span class="sig-name descname"><span class="pre">btype</span></span><a class="headerlink" href="#torchfx.filter.LinkwitzRiley.btype" title="Link to this definition">#</a></dt>
<dd><p>The filter type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.LinkwitzRiley.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#torchfx.filter.LinkwitzRiley.order" title="Link to this definition">#</a></dt>
<dd><p>The filter order (must be even).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Two-way crossover at 2 kHz (woofer and tweeter):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowpass</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LinkwitzRiley</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">highpass</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LinkwitzRiley</span><span class="p">(</span><span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;full_range.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woofer_signal</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lowpass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tweeter_signal</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">highpass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># When combined: woofer_signal + tweeter_signal = wave (flat response)</span>
</pre></div>
</div>
<p>Subwoofer crossover at 80 Hz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">main_hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;music.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subwoofer</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">sub_lpf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mains</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">main_hpf</span>
</pre></div>
</div>
<p>Three-way crossover system:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Low: &lt;200 Hz, Mid: 200-3000 Hz, High: &gt;3000 Hz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid_hp</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid_lp</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woofer</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">low</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">midrange</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">mid_hp</span> <span class="o">|</span> <span class="n">mid_lp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tweeter</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">high</span>
</pre></div>
</div>
<p>Steep 8th-order crossover for difficult driver pairing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Key Properties of Linkwitz-Riley Filters:</dt><dd><ul class="simple">
<li><p>Magnitude sum: <a href="#id10"><span class="problematic" id="id11">|</span></a>H_LP|² + <a href="#id12"><span class="problematic" id="id13">|</span></a>H_HP|² = 1 (flat combined response)</p></li>
<li><p>Phase alignment: 0° difference at crossover frequency</p></li>
<li><p>Slope: 6 * order dB/octave (e.g., 24 dB/octave for 4th order)</p></li>
<li><p>Crossover point: -6 dB for both filters</p></li>
</ul>
</dd>
<dt>Advantages over other crossover designs:</dt><dd><ul class="simple">
<li><p>No peaks or dips when signals are summed</p></li>
<li><p>Excellent phase coherence</p></li>
<li><p>Predictable, well-behaved response</p></li>
<li><p>Industry-standard for professional audio</p></li>
</ul>
</dd>
<dt>Common crossover orders:</dt><dd><ul class="simple">
<li><p>2nd order (LR2): 12 dB/octave, wide transition, good for close drivers</p></li>
<li><p>4th order (LR4): 24 dB/octave, most popular, good all-around</p></li>
<li><p>8th order (LR8): 48 dB/octave, steep isolation, for problem cases</p></li>
</ul>
</dd>
</dl>
<p>The filter is formed by cascading two Butterworth filters of half the specified
order. For example, a 4th-order LR filter uses two 2nd-order Butterworth filters.
This is implemented by convolving the Butterworth coefficients with themselves.</p>
<p>Physical interpretation: The -6 dB crossover point means each driver contributes
equally to the acoustic output at the crossover frequency, resulting in flat
total response when properly aligned.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Linkwitz, S. H., &amp; Riley, R. (1976). “Active Crossover Networks for
Noncoincident Drivers.” Journal of the Audio Engineering Society, 24(1), 2-8.</p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiLinkwitzRiley" title="torchfx.filter.HiLinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiLinkwitzRiley</span></code></a></dt><dd><p>High-pass Linkwitz-Riley convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoLinkwitzRiley" title="torchfx.filter.LoLinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoLinkwitzRiley</span></code></a></dt><dd><p>Low-pass Linkwitz-Riley convenience class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Base Butterworth filter used in LR construction</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.LinkwitzRiley.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LinkwitzRiley.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LinkwitzRiley.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter coefficients.</p>
<p>The method calculates the coefficients for a Butterworth filter of half the
specified order and then cascades it with itself by convolving the numerator and
denominator coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiLinkwitzRiley">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiLinkwitzRiley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiLinkwitzRiley"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiLinkwitzRiley" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.LinkwitzRiley" title="torchfx.filter.iir.LinkwitzRiley"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a></p>
<p>High-pass Linkwitz-Riley crossover filter convenience class.</p>
<p>This convenience class creates a high-pass Linkwitz-Riley filter by
automatically setting btype=”highpass”. Used in crossover networks to
send high frequencies to tweeters or mid-range drivers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Crossover frequency in Hz (-6 dB point).</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order (must be even). Common values: 2, 4, 8.</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Tweeter crossover at 3 kHz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;full_range.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tweeter</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">hpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.LinkwitzRiley" title="torchfx.filter.LinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a></dt><dd><p>Base Linkwitz-Riley filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoLinkwitzRiley" title="torchfx.filter.LoLinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoLinkwitzRiley</span></code></a></dt><dd><p>Low-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoLinkwitzRiley">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoLinkwitzRiley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoLinkwitzRiley"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoLinkwitzRiley" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.LinkwitzRiley" title="torchfx.filter.iir.LinkwitzRiley"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a></p>
<p>Low-pass Linkwitz-Riley crossover filter convenience class.</p>
<p>This convenience class creates a low-pass Linkwitz-Riley filter by
automatically setting btype=”lowpass”. Used in crossover networks to
send low frequencies to woofers or subwoofers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Crossover frequency in Hz (-6 dB point).</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=4</em>) – Filter order (must be even). Common values: 2, 4, 8.</p></li>
<li><p><strong>order_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – Order scaling mode.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Subwoofer crossover at 80 Hz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoLinkwitzRiley</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;music.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subwoofer</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lpf</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.LinkwitzRiley" title="torchfx.filter.LinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a></dt><dd><p>Base Linkwitz-Riley filter class</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiLinkwitzRiley" title="torchfx.filter.HiLinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiLinkwitzRiley</span></code></a></dt><dd><p>High-pass variant</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
</section>
<section id="equalizers-and-specialty-filters">
<h3>Equalizers and Specialty Filters<a class="headerlink" href="#equalizers-and-specialty-filters" title="Link to this heading">#</a></h3>
<section id="shelving-filters">
<h4>Shelving Filters<a class="headerlink" href="#shelving-filters" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.HiShelving">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">HiShelving</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiShelving"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiShelving" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Shelving</span></code></p>
<p>High-frequency shelving filter for treble control.</p>
<p>A high-shelving filter boosts or cuts frequencies above the cutoff frequency.
This filter is commonly used in audio equalization to adjust treble/brightness,
air frequencies, or apply de-emphasis curves. It provides smooth, gradual
transitions similar to analog tone controls.</p>
<p>The filter affects all frequencies above the cutoff with a constant gain in dB,
creating a shelf-like frequency response. The transition steepness is controlled
by the Q parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transition frequency in Hz. Frequencies above this will be boosted or cut.
Common values:
- 2000-4000 Hz: Presence boost/cut
- 6000-8000 Hz: Brightness control
- 10000-12000 Hz: Air/sparkle adjustment</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Quality factor controlling transition steepness. Typical values:
- 0.5: Gentle, analog-like transition
- 0.707: Standard transition (Butterworth-like)
- 1.0: Steeper transition</p></li>
<li><p><strong>gain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Shelf gain amount. Interpretation depends on gain_scale:
- For “linear”: Linear gain factor (e.g., 2.0 for +6 dB)
- For “db”: Gain in dB (e.g., 6.0 for +6 dB boost, -3.0 for cut)</p></li>
<li><p><strong>gain_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – How to interpret the gain parameter:
- “linear”: Direct linear gain multiplier
- “db”: Gain in decibels (converted internally to linear)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.HiShelving.gain">
<span class="sig-name descname"><span class="pre">gain</span></span><a class="headerlink" href="#torchfx.filter.HiShelving.gain" title="Link to this definition">#</a></dt>
<dd><p>The linear gain factor (converted from dB if necessary).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Boost high frequencies for brightness:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;dull_recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bright</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p>Cut harsh high frequencies:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;harsh.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smooth</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p>Add air to vocals:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">air_shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">12000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocals</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;vocals.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airy_vocals</span> <span class="o">=</span> <span class="n">vocals</span> <span class="o">|</span> <span class="n">air_shelf</span>
</pre></div>
</div>
<p>Using linear gain (2.0 = approximately +6 dB):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>High-shelving filters are one of the most commonly used EQ types in audio
production. They’re essential for:</p>
<blockquote>
<div><ul class="simple">
<li><p>Brightening dull recordings</p></li>
<li><p>Taming harsh cymbals or sibilance</p></li>
<li><p>Adding presence to vocals</p></li>
<li><p>Adjusting overall tonal balance</p></li>
</ul>
</div></blockquote>
<p>The filter uses the Audio EQ Cookbook biquad equations, providing accurate
analog-style shelving response. The Q parameter affects how quickly the
transition occurs but doesn’t affect the final shelf gain.</p>
<p>For subtle, musical adjustments, use moderate Q values (0.5-0.707) and moderate
gains (±3 to ±6 dB). Higher Q values create steeper transitions but may sound
less natural.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.LoShelving" title="torchfx.filter.LoShelving"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoShelving</span></code></a></dt><dd><p>Low-frequency shelving filter</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.ParametricEQ" title="torchfx.filter.ParametricEQ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParametricEQ</span></code></a></dt><dd><p>Parametric bell-shaped filter</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Shelving</span></code></dt><dd><p>Base class for shelving filters</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.HiShelving.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#HiShelving.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.HiShelving.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id15">
<h5>Implementation Requirements<a class="headerlink" href="#id15" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.LoShelving">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">LoShelving</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoShelving"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoShelving" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Shelving</span></code></p>
<p>Low-frequency shelving filter for bass control.</p>
<p>A low-shelving filter boosts or cuts frequencies below the cutoff frequency.
This filter is commonly used in audio equalization to adjust bass frequencies,
add warmth, reduce muddiness, or apply bass management. It provides smooth,
gradual transitions similar to analog bass/treble controls.</p>
<p>The filter affects all frequencies below the cutoff with a constant gain in dB,
creating a shelf-like frequency response. The transition steepness is controlled
by the Q parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transition frequency in Hz. Frequencies below this will be boosted or cut.
Common values:
- 60-100 Hz: Sub-bass control
- 100-200 Hz: Bass warmth/muddiness
- 200-400 Hz: Low-mid body
- 400-800 Hz: Fullness/boxiness</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Quality factor controlling transition steepness. Higher Q values result in
steeper transitions. Typical values:
- 0.5: Gentle, wide transition (musical, analog-like)
- 0.707: Moderate transition (common default, Butterworth-like)
- 1.0: Steeper transition
- 2.0+: Very steep transition</p></li>
<li><p><strong>gain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Shelf gain amount. Interpretation depends on gain_scale:
- For “linear”: Linear gain factor (e.g., 2.0 for +6 dB)
- For “db”: Gain in dB (e.g., 6.0 for +6 dB boost, -3.0 for cut)</p></li>
<li><p><strong>gain_scale</strong> (<em>{&quot;linear&quot;</em><em>, </em><em>&quot;db&quot;}</em><em>, </em><em>default=&quot;linear&quot;</em>) – How to interpret the gain parameter:
- “linear”: Direct linear gain multiplier
- “db”: Gain in decibels (converted internally to linear)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – The sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.LoShelving.gain">
<span class="sig-name descname"><span class="pre">gain</span></span><a class="headerlink" href="#torchfx.filter.LoShelving.gain" title="Link to this definition">#</a></dt>
<dd><p>The linear gain factor (converted from dB if necessary).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Add warmth by boosting low frequencies:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;thin_recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warm</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p>Reduce muddiness by cutting low-mids:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;muddy_mix.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p>Boost sub-bass for electronic music:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">track</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;edm_track.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">punchy</span> <span class="o">=</span> <span class="n">track</span> <span class="o">|</span> <span class="n">sub_shelf</span>
</pre></div>
</div>
<p>Using linear gain:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">shelf</span>
</pre></div>
</div>
<p>Combining low and high shelving for complete tonal shaping:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lo_shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">LoShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hi_shelf</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">HiShelving</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">gain_scale</span><span class="o">=</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shaped</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">lo_shelf</span> <span class="o">|</span> <span class="n">hi_shelf</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Low-shelving filters are fundamental tools in audio production for:</dt><dd><ul class="simple">
<li><p>Adding warmth and body to thin recordings</p></li>
<li><p>Reducing muddiness in the low-midrange</p></li>
<li><p>Bass management and room correction</p></li>
<li><p>Matching tonal balance between tracks</p></li>
<li><p>Creating vintage or “warm” sound characteristics</p></li>
</ul>
</dd>
</dl>
<p>The filter uses the Audio EQ Cookbook biquad equations, providing accurate
analog-style shelving response. The Q parameter controls transition steepness
but doesn’t affect the final shelf gain.</p>
<dl class="simple">
<dt>Common Applications:</dt><dd><ul class="simple">
<li><p>Mastering: Subtle low-end adjustments (±2 to ±4 dB at 80-150 Hz)</p></li>
<li><p>Mixing: Controlling bass buildup (cuts at 100-300 Hz)</p></li>
<li><p>Sound design: Creating warmth or thickness</p></li>
<li><p>Broadcast: Meeting bass response standards</p></li>
</ul>
</dd>
</dl>
<p>For musical, natural-sounding results, use moderate Q values (0.5-0.707) and
conservative gains (±3 to ±6 dB). Excessive low-frequency boost can cause
distortion, speaker damage, or headroom issues.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Bristow-Johnson, R. “Cookbook formulae for audio EQ biquad filter
coefficients.” <a class="reference external" href="https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html">https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html</a></p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#torchfx.filter.HiShelving" title="torchfx.filter.HiShelving"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiShelving</span></code></a></dt><dd><p>High-frequency shelving filter</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.ParametricEQ" title="torchfx.filter.ParametricEQ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParametricEQ</span></code></a></dt><dd><p>Parametric bell-shaped filter</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Shelving</span></code></dt><dd><p>Base class for shelving filters</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.LoShelving.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#LoShelving.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.LoShelving.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id17">
<h5>Implementation Requirements<a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="parametric-eq">
<h4>Parametric EQ<a class="headerlink" href="#parametric-eq" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">ParametricEQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#ParametricEQ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.ParametricEQ" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Parametric equalizer with bell-shaped frequency response.</p>
<p>A parametric EQ is a bell-shaped filter (also called a peaking filter) that
boosts or cuts a specific frequency range. It’s the most versatile and commonly
used type of EQ in music production, audio mastering, and live sound reinforcement,
providing precise control over frequency, bandwidth, and gain.</p>
<p>Unlike shelving filters that affect all frequencies above or below a cutoff,
parametric EQs create a localized boost or cut centered at a specific frequency,
with the bandwidth controlled by the Q parameter. This makes them ideal for
surgical frequency adjustments, tonal shaping, and corrective equalization.</p>
<p>The filter is implemented using the Audio EQ Cookbook biquad equations,
providing accurate analog-style peaking response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Center frequency in Hz where the peak or dip occurs. This is the frequency
that receives the maximum boost or cut. Common applications:
- 100-250 Hz: Body, warmth, or muddiness control
- 250-500 Hz: Fullness or boxiness
- 500-2000 Hz: Presence, honk, or nasality
- 2000-5000 Hz: Clarity, definition, or harshness
- 5000-10000 Hz: Brilliance, air, or sibilance
- 10000+ Hz: Sparkle or extreme high-frequency detail</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Quality factor (Q) controlling the bandwidth of the filter. Higher Q
values result in narrower, more focused adjustments. The bandwidth in Hz
is approximately frequency / Q. Typical values:
- 0.3-0.5: Very wide, gentle, musical (subtle tonal shaping)
- 0.7-1.0: Wide, natural (general tonal adjustments)
- 1.0-2.0: Moderate, focused (typical mixing applications)
- 2.0-5.0: Narrow, surgical (problem frequency removal)
- 5.0-10.0: Very narrow (feedback suppression, notch-like)
- 10.0+: Extremely narrow (surgical removal)</p></li>
<li><p><strong>gain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Gain in dB at the center frequency. Positive values boost, negative
values cut. Typical values:
- ±1-2 dB: Subtle, transparent adjustments
- ±3-6 dB: Moderate, audible changes
- ±6-12 dB: Aggressive, obvious EQ
- ±12+ dB: Extreme correction (use with caution)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#torchfx.filter.ParametricEQ.cutoff" title="Link to this definition">#</a></dt>
<dd><p>The center frequency (stored internally).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ.q">
<span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#torchfx.filter.ParametricEQ.q" title="Link to this definition">#</a></dt>
<dd><p>The quality factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ.gain_db">
<span class="sig-name descname"><span class="pre">gain_db</span></span><a class="headerlink" href="#torchfx.filter.ParametricEQ.gain_db" title="Link to this definition">#</a></dt>
<dd><p>The gain in dB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ.gain">
<span class="sig-name descname"><span class="pre">gain</span></span><a class="headerlink" href="#torchfx.filter.ParametricEQ.gain" title="Link to this definition">#</a></dt>
<dd><p>The linear gain factor (10^(gain_db/20)).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Boost presence at 3 kHz for vocal clarity:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocals</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;vocals.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clear_vocals</span> <span class="o">=</span> <span class="n">vocals</span> <span class="o">|</span> <span class="n">eq</span>
</pre></div>
</div>
<p>Cut muddy low-mids at 250 Hz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;mix.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean_mix</span> <span class="o">=</span> <span class="n">mix</span> <span class="o">|</span> <span class="n">eq</span>
</pre></div>
</div>
<p>Add warmth with wide boost at 120 Hz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bass</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;bass.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warm_bass</span> <span class="o">=</span> <span class="n">bass</span> <span class="o">|</span> <span class="n">eq</span>
</pre></div>
</div>
<p>Surgical removal of resonance at 800 Hz:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guitar</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;guitar.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smooth_guitar</span> <span class="o">=</span> <span class="n">guitar</span> <span class="o">|</span> <span class="n">eq</span>
</pre></div>
</div>
<p>Multiple EQ bands in series:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Low-mid cut, presence boost, air boost</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq1</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq2</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq3</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq_chain</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">eq1</span> <span class="o">|</span> <span class="n">eq2</span> <span class="o">|</span> <span class="n">eq3</span>
</pre></div>
</div>
<p>Feedback suppression with very narrow Q:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Identify feedback frequency (e.g., 2450 Hz), then apply narrow cut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch_eq</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">ParametricEQ</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="mi">2450</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">live_mix</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;live.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">controlled</span> <span class="o">=</span> <span class="n">live_mix</span> <span class="o">|</span> <span class="n">notch_eq</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Q Factor and Bandwidth Relationship:</dt><dd><ul class="simple">
<li><p>Bandwidth (Hz) ≈ frequency / Q</p></li>
<li><p>Bandwidth (octaves) ≈ 2 * sinh⁻¹(1/(2Q)) / ln(2)</p></li>
<li><p>Low Q (&lt; 1): Wide bandwidth, affects many frequencies, musical</p></li>
<li><p>Medium Q (≈ 1): Moderate bandwidth, natural sound</p></li>
<li><p>High Q (&gt; 2): Narrow bandwidth, focused correction, can sound unnatural</p></li>
</ul>
</dd>
<dt>Common Applications:</dt><dd><ul class="simple">
<li><p>Vocal production: Boost 2-5 kHz for clarity, cut 200-400 Hz for muddiness</p></li>
<li><p>Kick drum: Boost 60-80 Hz for thump, 3-5 kHz for attack</p></li>
<li><p>Snare: Boost 200 Hz for body, 5 kHz for snap</p></li>
<li><p>Bass: Cut 200-300 Hz for clarity, boost 80-100 Hz for weight</p></li>
<li><p>Acoustic guitar: Boost 5-7 kHz for sparkle, cut 200-300 Hz for mud</p></li>
<li><p>Mix mastering: Subtle adjustments (±1-3 dB, Q=0.5-1.0)</p></li>
</ul>
</dd>
<dt>Best Practices:</dt><dd><ul class="simple">
<li><p>Start with narrow Q to identify problem frequencies, then widen for musical result</p></li>
<li><p>Use cuts more than boosts (subtractive EQ philosophy)</p></li>
<li><p>Lower frequencies generally need wider Q (lower Q values)</p></li>
<li><p>Higher frequencies can use narrower Q without sounding unnatural</p></li>
<li><p>A/B compare frequently to avoid over-EQing</p></li>
<li><p>Use multiple gentle bands rather than one extreme adjustment</p></li>
</ul>
</dd>
</dl>
<p>The parametric EQ uses the following biquad equations from the Audio EQ Cookbook:</p>
<blockquote>
<div><p>ω₀ = 2π * frequency / fs
α = sin(ω₀) / (2 * Q)
A = 10^(gain/20)</p>
<p>b₀ = 1 + α * A
b₁ = -2 * cos(ω₀)
b₂ = 1 - α * A
a₀ = 1 + α / A
a₁ = -2 * cos(ω₀)
a₂ = 1 - α / A</p>
</div></blockquote>
<p>Caution: Very high Q values (&gt;10) can cause ringing artifacts and may sound
unnatural. Very large gain values (&gt;12 dB) can introduce distortion and
reduce headroom. Always monitor levels after applying EQ.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id18" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Bristow-Johnson, R. “Cookbook formulae for audio EQ biquad filter
coefficients.” <a class="reference external" href="https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html">https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html</a></p>
</aside>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Peaking</span></code></dt><dd><p>General peaking filter implementation</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.HiShelving" title="torchfx.filter.HiShelving"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HiShelving</span></code></a></dt><dd><p>High-frequency shelving filter</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LoShelving" title="torchfx.filter.LoShelving"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoShelving</span></code></a></dt><dd><p>Low-frequency shelving filter</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Notch" title="torchfx.filter.Notch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Notch</span></code></a></dt><dd><p>Notch filter for frequency rejection</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.ParametricEQ.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#ParametricEQ.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.ParametricEQ.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter coefficients using the Audio EQ Cookbook formulas.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="other-filters">
<h4>Other Filters<a class="headerlink" href="#other-filters" title="Link to this heading">#</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.Notch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">Notch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Notch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Notch" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>Notch filter for narrow-band frequency rejection.</p>
<p>A notch filter (also called a band-stop or band-reject filter) attenuates a
narrow band of frequencies centered around a specified frequency. This is ideal
for removing tonal interference, hum, resonances, or feedback frequencies
without affecting the surrounding spectrum.</p>
<p>The filter creates a sharp dip in the frequency response at the notch frequency,
with the width of the notch controlled by the Q parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Notch center frequency in Hz. This frequency will be maximally attenuated.
Common applications:
- 50 Hz: Mains hum (Europe, Australia)
- 60 Hz: Mains hum (North America, Japan)
- 100/120 Hz: Second harmonic of mains hum
- Any resonant frequency or feedback tone</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Quality factor determining the notch width. Higher Q values result in
narrower notches that affect fewer adjacent frequencies. The notch
bandwidth in Hz is approximately cutoff / Q. Typical values:
- 5-10: Wide notch, affects broader frequency range
- 10-30: Moderate notch (common for hum removal)
- 30+: Very narrow notch, surgical removal</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Notch.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#torchfx.filter.Notch.cutoff" title="Link to this definition">#</a></dt>
<dd><p>The notch center frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.Notch.q">
<span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#torchfx.filter.Notch.q" title="Link to this definition">#</a></dt>
<dd><p>The quality factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Remove 60 Hz mains hum:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;humming_recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">notch</span>
</pre></div>
</div>
<p>Remove 50 Hz hum (European mains):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">notch</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">notch</span>
</pre></div>
</div>
<p>Remove feedback frequency:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First identify the feedback frequency (e.g., 2350 Hz)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">2350</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;live_recording.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_feedback</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">notch</span>
</pre></div>
</div>
<p>Remove multiple hum harmonics:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove 60 Hz fundamental and 120 Hz harmonic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch1</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notch2</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;humming.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">notch1</span> <span class="o">|</span> <span class="n">notch2</span>
</pre></div>
</div>
<p>Wide notch for resonance control:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">notch</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Notch</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;resonant.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">controlled</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">notch</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Notch filters are essential tools for:</dt><dd><ul class="simple">
<li><p>Removing mains hum (50/60 Hz) and harmonics</p></li>
<li><p>Eliminating feedback frequencies in live sound</p></li>
<li><p>Reducing room resonances and standing waves</p></li>
<li><p>Removing tonal interference (AC hum, electrical noise)</p></li>
<li><p>De-essing (though specialized de-essers are often better)</p></li>
</ul>
</dd>
<dt>The Q parameter is critical:</dt><dd><ul class="simple">
<li><p>Too low: Notch is wide and affects too many frequencies, causing
audible coloration</p></li>
<li><p>Too high: Notch may not be wide enough to fully remove the problem
frequency, especially if it varies slightly</p></li>
</ul>
</dd>
</dl>
<p>For hum removal, Q values of 20-30 are typical. For surgical removal of
specific tones, Q values up to 50-100 can be used, but be aware that very
high Q filters can ring or become unstable.</p>
<p>The notch filter is implemented using scipy.signal.iirnotch, which designs
a second-order IIR notch filter with maximum attenuation at the specified
frequency.</p>
<p>Caution: Overuse of notch filters can make audio sound unnatural. Use
sparingly and only when necessary. Consider addressing the source of the
problem (ground loops, shielding, etc.) rather than filtering.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Peaking</span></code></dt><dd><p>Peaking filter (inverse of notch)</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.ParametricEQ" title="torchfx.filter.ParametricEQ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParametricEQ</span></code></a></dt><dd><p>Parametric EQ for boosting/cutting frequency bands</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.Butterworth" title="torchfx.filter.Butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Butterworth</span></code></a></dt><dd><p>Broader frequency control</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.Notch.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#Notch.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.Notch.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id19">
<h5>Implementation Requirements<a class="headerlink" href="#id19" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchfx.filter.AllPass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchfx.filter.</span></span><span class="sig-name descname"><span class="pre">AllPass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#AllPass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.AllPass" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchfx.filter.IIR" title="torchfx.filter.iir.IIR"><code class="xref py py-class docutils literal notranslate"><span class="pre">IIR</span></code></a></p>
<p>All-pass filter for phase manipulation without magnitude change.</p>
<p>An all-pass filter passes all frequencies with unity magnitude (no amplitude
change) but introduces frequency-dependent phase shift. These filters are
primarily used for phase correction, creating reverb/delay effects, and
designing crossover networks with linear phase response.</p>
<p>While the magnitude response is flat across all frequencies, the phase response
varies with frequency, which can be used to align phase between different signal
paths or create time-domain dispersion effects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Center frequency in Hz where maximum phase shift occurs. The phase shift
is frequency-dependent, with maximum shift at this frequency.</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Quality factor controlling the rate of phase change. Higher Q values result
in more rapid phase transitions around the center frequency.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>default=None</em>) – Sampling frequency in Hz.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.AllPass.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#torchfx.filter.AllPass.cutoff" title="Link to this definition">#</a></dt>
<dd><p>The center frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchfx.filter.AllPass.q">
<span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#torchfx.filter.AllPass.q" title="Link to this definition">#</a></dt>
<dd><p>The quality factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Phase correction for speaker alignment:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torchfx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">allpass</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">AllPass</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.707</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;audio.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_shifted</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">allpass</span>
</pre></div>
</div>
<p>Creating a phaser effect (using multiple all-pass stages):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ap1</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">AllPass</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ap2</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">AllPass</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ap3</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">AllPass</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">fx</span><span class="o">.</span><span class="n">Wave</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;guitar.wav&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phased</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">|</span> <span class="n">ap1</span> <span class="o">|</span> <span class="n">ap2</span> <span class="o">|</span> <span class="n">ap3</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>All-pass filters have unique properties:</dt><dd><ul class="simple">
<li><p>Magnitude response: Unity gain at all frequencies (0 dB)</p></li>
<li><p>Phase response: Frequency-dependent, non-linear</p></li>
<li><p>Applications: Phase correction, reverb design, time dispersion</p></li>
</ul>
</dd>
<dt>Common uses in audio:</dt><dd><ul class="simple">
<li><p>Phase alignment in multi-driver speaker systems</p></li>
<li><p>Reverb algorithm building blocks</p></li>
<li><p>Creating vintage phaser/flanger effects</p></li>
<li><p>Group delay compensation</p></li>
<li><p>Hilbert transform implementation (90° phase shift)</p></li>
</ul>
</dd>
<dt>The all-pass filter is particularly useful in:</dt><dd><ul class="simple">
<li><p>Crossover networks: Aligning phase between drivers</p></li>
<li><p>Reverb design: Creating dense reflections and diffusion</p></li>
<li><p>Effect chains: Adding subtle movement and depth</p></li>
<li><p>Room correction: Compensating for acoustic phase distortions</p></li>
</ul>
</dd>
</dl>
<p>Implementation note: This uses scipy.signal.iirpeak which creates a peaking
filter structure. For a true all-pass filter, ensure the gain is set appropriately
(typically handled internally).</p>
<p>Caution: While all-pass filters don’t change magnitude, they do affect the time-
domain response and can introduce pre-ringing or post-ringing artifacts. Use
judiciously in critical listening applications.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Peaking</span></code></dt><dd><p>Peaking filter with magnitude change</p>
</dd>
<dt><a class="reference internal" href="#torchfx.filter.LinkwitzRiley" title="torchfx.filter.LinkwitzRiley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a></dt><dd><p>Crossover filters with phase-aligned outputs</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchfx.filter.AllPass.compute_coefficients">
<span class="sig-name descname"><span class="pre">compute_coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchfx/filter/iir.html#AllPass.compute_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchfx.filter.AllPass.compute_coefficients" title="Link to this definition">#</a></dt>
<dd><p>Compute the filter’s transfer function coefficients.</p>
<p>This abstract method must be implemented by all <cite>AbstractFilter</cite> subclasses.
It is responsible for computing the filter’s transfer function coefficients
(typically the numerator <cite>b</cite> and denominator <cite>a</cite> coefficients) and storing
them in instance attributes.</p>
<p>The method is called automatically during the first <cite>forward()</cite> pass when
the <cite>_has_computed_coeff</cite> property returns <cite>False</cite>. It should not be called
directly by users in typical usage scenarios.</p>
<section id="id20">
<h5>Implementation Requirements<a class="headerlink" href="#id20" title="Link to this heading">#</a></h5>
<p>Implementations of this method should:</p>
<ol class="arabic simple">
<li><p><strong>Verify sampling frequency</strong>: Check that <cite>self.fs</cite> is not <cite>None</cite> before
attempting to compute coefficients. Raise a <cite>ValueError</cite> if it is <cite>None</cite>.</p></li>
<li><p><strong>Design filter coefficients</strong>: Use SciPy signal processing functions
(e.g., <cite>scipy.signal.butter</cite>, <cite>scipy.signal.cheby1</cite>, <cite>scipy.signal.firwin</cite>)
or custom algorithms to compute filter coefficients based on the filter’s
parameters (cutoff frequency, order, Q factor, etc.).</p></li>
<li><p><strong>Store coefficients</strong>: Save the computed coefficients in instance attributes
(typically <cite>self.a</cite> for denominator and <cite>self.b</cite> for numerator).</p></li>
<li><p><strong>Normalize frequencies</strong>: For filters that use normalized frequencies
(most SciPy functions), normalize cutoff frequencies by the Nyquist
frequency (fs/2).</p></li>
</ol>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For IIR filters, both <cite>a</cite> (denominator) and <cite>b</cite> (numerator) coefficients
are typically stored as sequences or arrays.</p></li>
<li><p>For FIR filters, only <cite>b</cite> (numerator) coefficients are needed, with <cite>a</cite>
set to <cite>[1.0]</cite>.</p></li>
<li><p>Coefficients are initially stored as Python sequences or NumPy arrays and
are later converted to PyTorch tensors during the <cite>forward()</cite> pass.</p></li>
<li><p>This method should be deterministic - calling it multiple times with the
same parameters should produce identical coefficients.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If required parameters (especially <cite>fs</cite>) are not set before coefficient
    computation is attempted.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Implementing <cite>compute_coefficients</cite> for a Butterworth lowpass filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute Butterworth lowpass coefficients.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Normalize cutoff to Nyquist frequency</span>
<span class="gp">... </span>    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">normalized_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="n">nyquist</span>
<span class="gp">... </span>    <span class="c1"># Design filter using SciPy</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">normalized_cutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for a custom shelving filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute high-shelving filter coefficients using biquad formulas.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Calculate angular frequency</span>
<span class="gp">... </span>    <span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>
<span class="gp">... </span>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span>  <span class="c1"># Linear gain</span>
<span class="gp">... </span>    <span class="c1"># Compute biquad coefficients</span>
<span class="gp">... </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">b2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="gp">... </span>    <span class="c1"># Normalize by a0 and store</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b0</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">b2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a1</span><span class="o">/</span><span class="n">a0</span><span class="p">,</span> <span class="n">a2</span><span class="o">/</span><span class="n">a0</span><span class="p">]</span>
</pre></div>
</div>
<p>Implementing <cite>compute_coefficients</cite> for an FIR filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">firwin</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Compute FIR filter coefficients using window method.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling frequency must be set&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Use scipy firwin to design FIR filter</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">firwin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_taps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">pass_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_zero</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># FIR filters have trivial denominator</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="core.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Core Classes</p>
      </div>
    </a>
    <a class="right-next"
       href="effects.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Effects</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-classes">Base Classes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iir">IIR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR"><code class="docutils literal notranslate"><span class="pre">IIR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.fs"><code class="docutils literal notranslate"><span class="pre">IIR.fs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.cutoff"><code class="docutils literal notranslate"><span class="pre">IIR.cutoff</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.a"><code class="docutils literal notranslate"><span class="pre">IIR.a</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.b"><code class="docutils literal notranslate"><span class="pre">IIR.b</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.forward"><code class="docutils literal notranslate"><span class="pre">IIR.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.IIR.move_coeff"><code class="docutils literal notranslate"><span class="pre">IIR.move_coeff()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fir-filters">FIR Filters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fir">FIR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.FIR"><code class="docutils literal notranslate"><span class="pre">FIR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.FIR.kernel"><code class="docutils literal notranslate"><span class="pre">FIR.kernel</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.FIR.a"><code class="docutils literal notranslate"><span class="pre">FIR.a</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.FIR.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">FIR.compute_coefficients()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.FIR.forward"><code class="docutils literal notranslate"><span class="pre">FIR.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#designablefir">DesignableFIR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR"><code class="docutils literal notranslate"><span class="pre">DesignableFIR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.cutoff"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.cutoff</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.num_taps"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.num_taps</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.fs"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.fs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.pass_zero"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.pass_zero</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.window"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.window</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.b"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.b</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.kernel"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.kernel</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.a"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.a</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.DesignableFIR.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.compute_coefficients()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">DesignableFIR.compute_coefficients()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#iir-filters">IIR Filters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-filters">Standard Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth">Butterworth</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Butterworth"><code class="docutils literal notranslate"><span class="pre">Butterworth</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Butterworth.btype"><code class="docutils literal notranslate"><span class="pre">Butterworth.btype</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Butterworth.order"><code class="docutils literal notranslate"><span class="pre">Butterworth.order</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Butterworth.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">Butterworth.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiButterworth"><code class="docutils literal notranslate"><span class="pre">HiButterworth</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoButterworth"><code class="docutils literal notranslate"><span class="pre">LoButterworth</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-i">Chebyshev Type I</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev1"><code class="docutils literal notranslate"><span class="pre">Chebyshev1</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev1.btype"><code class="docutils literal notranslate"><span class="pre">Chebyshev1.btype</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev1.order"><code class="docutils literal notranslate"><span class="pre">Chebyshev1.order</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev1.ripple"><code class="docutils literal notranslate"><span class="pre">Chebyshev1.ripple</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev1.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">Chebyshev1.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiChebyshev1"><code class="docutils literal notranslate"><span class="pre">HiChebyshev1</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoChebyshev1"><code class="docutils literal notranslate"><span class="pre">LoChebyshev1</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-ii">Chebyshev Type II</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev2"><code class="docutils literal notranslate"><span class="pre">Chebyshev2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev2.btype"><code class="docutils literal notranslate"><span class="pre">Chebyshev2.btype</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev2.order"><code class="docutils literal notranslate"><span class="pre">Chebyshev2.order</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev2.ripple"><code class="docutils literal notranslate"><span class="pre">Chebyshev2.ripple</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Chebyshev2.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">Chebyshev2.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiChebyshev2"><code class="docutils literal notranslate"><span class="pre">HiChebyshev2</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoChebyshev2"><code class="docutils literal notranslate"><span class="pre">LoChebyshev2</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic">Elliptic</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic"><code class="docutils literal notranslate"><span class="pre">Elliptic</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic.btype"><code class="docutils literal notranslate"><span class="pre">Elliptic.btype</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic.order"><code class="docutils literal notranslate"><span class="pre">Elliptic.order</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic.passband_ripple"><code class="docutils literal notranslate"><span class="pre">Elliptic.passband_ripple</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic.stopband_attenuation"><code class="docutils literal notranslate"><span class="pre">Elliptic.stopband_attenuation</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Elliptic.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">Elliptic.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiElliptic"><code class="docutils literal notranslate"><span class="pre">HiElliptic</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoElliptic"><code class="docutils literal notranslate"><span class="pre">LoElliptic</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linkwitz-riley">Linkwitz-Riley</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LinkwitzRiley"><code class="docutils literal notranslate"><span class="pre">LinkwitzRiley</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LinkwitzRiley.btype"><code class="docutils literal notranslate"><span class="pre">LinkwitzRiley.btype</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LinkwitzRiley.order"><code class="docutils literal notranslate"><span class="pre">LinkwitzRiley.order</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LinkwitzRiley.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">LinkwitzRiley.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiLinkwitzRiley"><code class="docutils literal notranslate"><span class="pre">HiLinkwitzRiley</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoLinkwitzRiley"><code class="docutils literal notranslate"><span class="pre">LoLinkwitzRiley</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equalizers-and-specialty-filters">Equalizers and Specialty Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shelving-filters">Shelving Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiShelving"><code class="docutils literal notranslate"><span class="pre">HiShelving</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiShelving.gain"><code class="docutils literal notranslate"><span class="pre">HiShelving.gain</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.HiShelving.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">HiShelving.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoShelving"><code class="docutils literal notranslate"><span class="pre">LoShelving</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoShelving.gain"><code class="docutils literal notranslate"><span class="pre">LoShelving.gain</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.LoShelving.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">LoShelving.compute_coefficients()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-eq">Parametric EQ</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ"><code class="docutils literal notranslate"><span class="pre">ParametricEQ</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ.cutoff"><code class="docutils literal notranslate"><span class="pre">ParametricEQ.cutoff</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ.q"><code class="docutils literal notranslate"><span class="pre">ParametricEQ.q</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ.gain_db"><code class="docutils literal notranslate"><span class="pre">ParametricEQ.gain_db</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ.gain"><code class="docutils literal notranslate"><span class="pre">ParametricEQ.gain</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.ParametricEQ.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">ParametricEQ.compute_coefficients()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-filters">Other Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Notch"><code class="docutils literal notranslate"><span class="pre">Notch</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Notch.cutoff"><code class="docutils literal notranslate"><span class="pre">Notch.cutoff</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Notch.q"><code class="docutils literal notranslate"><span class="pre">Notch.q</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.Notch.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">Notch.compute_coefficients()</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.AllPass"><code class="docutils literal notranslate"><span class="pre">AllPass</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.AllPass.cutoff"><code class="docutils literal notranslate"><span class="pre">AllPass.cutoff</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.AllPass.q"><code class="docutils literal notranslate"><span class="pre">AllPass.q</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#torchfx.filter.AllPass.compute_coefficients"><code class="docutils literal notranslate"><span class="pre">AllPass.compute_coefficients()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/matteospanio/torchfx/edit/main/docs/source/api/filters.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/filters.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Matteo Spanio.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>